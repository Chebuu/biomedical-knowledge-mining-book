[
["index.html", "Biomedical Knowledge Mining using GOSemSim and clusterProfiler üìñ Introduction üéØ Motivation üìù Citation üìö Book structure üíñ Want to help?", " Biomedical Knowledge Mining using GOSemSim and clusterProfiler Guangchuang Yu, PhD Department of Bioinformatics, School of Basic Medical Sciences, Southern Medical Universityguangchuangyu@gmail.com 2020-09-08 üìñ Introduction hello üéØ Motivation The book is meant as a guide for mining biological knowledge to elucidate or interpret molecular mechanisms using a suite of R packages, including ChIPseeker, clusterProfiler, DOSE, enrichplot, GOSemSim, meshes and ReactomePA. Hence, if you are starting to read this book, we assume you have a working knowledge of how to use R. üìù Citation If you use the software suite in published research, please cite the most appropriate paper(s) from this list: G Yu*. Gene Ontology Semantic Similarity Analysis Using GOSemSim. In: Kidder B. (eds) Stem Cell Transcriptional Networks. Methods in Molecular Biology. 2020, 2117:207-215. Humana, New York, NY. doi: 10.1007/978-1-0716-0301-7_11 G Yu*. Using meshes for MeSH term enrichment and semantic analyses. Bioinformatics. 2018, 34(21):3766‚Äì3767. doi: 10.1093/bioinformatics/bty410 G Yu, QY He*. ReactomePA: an R/Bioconductor package for reactome pathway analysis and visualization. Molecular BioSystems. 2016, 12(2):477-479. doi: 10.1039/C5MB00663E G Yu*, LG Wang, and QY He*. ChIPseeker: an R/Bioconductor package for ChIP peak annotation, comparison and visualization. Bioinformatics. 2015, 31(14):2382-2383. doi: 10.1093/bioinformatics/btv145 G Yu*, LG Wang, GR Yan, QY He*. DOSE: an R/Bioconductor package for Disease Ontology Semantic and Enrichment analysis. Bioinformatics. 2015, 31(4):608-609. doi: 10.1093/bioinformatics/btu684 G Yu, LG Wang, Y Han and QY He*. clusterProfiler: an R package for comparing biological themes among gene clusters. OMICS: A Journal of Integrative Biology. 2012, 16(5):284-287. doi: 10.1089/omi.2011.0118 G Yu, F Li, Y Qin, X Bo*, Y Wu, S Wang*. GOSemSim: an R package for measuring semantic similarity among GO terms and gene products. Bioinformatics. 2010, 26(7):976-978. doi: 10.1093/bioinformatics/btq064 üìö Book structure Part 1 (Semantic similarity analysis) describes GOSemSim, DOSE and meshes packages for measuring semantic similarity of genes or gene products based on Gene Ontology, Disease Ontology and Medical Subject Headings. Part 2 (Enrichment analysis) introduces over-reprensentation analysis and gene set enrichment analysis using clusterProfiler (supports GO, KEGG, MSigDb, WikiPathway, and many others via universal interface), DOSE (DO, Disease-Gene Network, Network of Cancer Genes), meshes (MeSH), and ReactomePA (Reactome pathway). Functional enrichment analysis of Genomic coordination is supported via ChIPseeker and comparison among multiple conditions is also supported by clusterProfiler. We implemented a number of visualization methods in the enrichplot package to help users to interpret their results. Part 3 (Miscellaneous topics) describes useful utilities including translating gene IDs and manipulating enrichment results. üíñ Want to help? The book‚Äôs source code is hosted on GitHub, at https://github.com/YuLab-SMU/biomedical-knowledge-mining-book. Any feedback on the book is very welcome. Feel free to open an issue on GitHub or send me a pull request if you notice typos or other issues (I‚Äôm not a native English speaker ;) ). "],
["semantic-similarity-overview.html", "Chapter 1 Overview of semantic similarity analysis 1.1 Information content-based methods 1.2 Graph-based method 1.3 Combine methods 1.4 Summary", " Chapter 1 Overview of semantic similarity analysis Functional similarity of gene products can be estimated by controlled biological vocabularies, such as Gene Ontology (GO), Disease Ontology (DO) and Medical Subject Headings (MeSH). Four methods including Resnik (Philip 1999), Jiang (Jiang and Conrath 1997), Lin (Lin 1998) and Schlicker (Schlicker et al. 2006) have been presented to determine the semantic similarity of two GO terms based on the annotation statistics of their common ancestor terms. Wang (Wang et al. 2007) proposed a method to measure the similarity based on the graph structure of GO. Each of these methods has its own advantages and weaknesses and can be applied to other ontologies that have similar structure (i.e.¬†directed acyclic graph). 1.1 Information content-based methods Four methods proposed by Resnik (Philip 1999), Jiang (Jiang and Conrath 1997), Lin (Lin 1998) and Schlicker (Schlicker et al. 2006) are information content (IC) based, which depend on the frequencies of two GO terms involved and that of their closest common ancestor term in a specific corpus of GO annotations. The information content of a GO term is computed by the negative log probability of the term occurring in GO corpus. A rarely used term contains a greater amount of information. The frequency of a term t is defined as: \\[p(t) = \\frac{n_{t&#39;}}{N} | t&#39; \\in \\left\\{t, \\; children\\: of\\: t \\right\\}\\] where \\(n_{t&#39;}\\) is the number of term \\(t&#39;\\), and \\(N\\) is the total number of terms in GO corpus. Thus the information content is defined as: \\[IC(t) = -\\log(p(t))\\] As GO allow multiple parents for each concept, two terms can share parents by multiple paths. IC-based methods calculate similarity of two GO terms based on the information content of their closest common ancestor term, which was also called most informative common ancestor (MICA). 1.1.1 Resnik method The Resnik method is defined as: \\[sim_{Resnik}(t_1,t_2) = IC(MICA)\\] 1.1.2 Lin method The Lin method is defined as: \\[sim_{Lin}(t_1,t_2) = \\frac{2IC(MICA)}{IC(t_1)+IC(t_2)}\\] 1.1.3 Rel method The Relevance method, which was proposed by Schlicker, combine Resnik‚Äôs and Lin‚Äôs method and is defined as: \\[sim_{Rel}(t_1,t_2) = \\frac{2IC(MICA)(1-p(MICA))}{IC(t_1)+IC(t_2)}\\] 1.1.4 Jiang method The Jiang and Conrath‚Äôs method is defined as: \\[sim_{Jiang}(t_1,t_2) = 1-\\min(1, IC(t_1) + IC(t_2) - 2IC(MICA))\\] 1.2 Graph-based method Graph-based methods using the topology of GO graph structure to compute semantic similarity. Formally, a GO term A can be represented as \\(DAG_{A}=(A,T_{A},E_{A})\\) where \\(T_{A}\\) is the set of GO terms in \\(DAG_{A}\\), including term A and all of its ancestor terms in the GO graph, and \\(E_{A}\\) is the set of edges connecting the GO terms in \\(DAG_{A}\\). 1.2.1 Wang method To encode the semantic of a GO term in a measurable format to enable a quantitative comparison, Wang(Wang et al. 2007) firstly defined the semantic value of term A as the aggregate contribution of all terms in \\(DAG_{A}\\) to the semantics of term A, terms closer to term A in \\(DAG_{A}\\) contribute more to its semantics. Thus, defined the contribution of a GO term \\(t\\) to the semantic of GO term \\(A\\) as the S-value of GO term \\(t\\) related to term \\(A\\). For any of term \\(t\\) in \\(DAG_{A}\\), its S-value related to term \\(A\\), \\(S_{A}(\\textit{t})\\) is defined as: \\[\\left\\{\\begin{array}{l} S_{A}(A)=1 \\\\ S_{A}(\\textit{t})=\\max\\{w_{e} \\times S_{A}(\\textit{t}&#39;) | \\textit{t}&#39; \\in children \\: of(\\textit{t}) \\} \\; if \\: \\textit{t} \\ne A \\end{array} \\right.\\] where \\(w_{e}\\) is the semantic contribution factor for edge \\(e \\in E_{A}\\) linking term \\(t\\) with its child term \\(t&#39;\\). Term \\(A\\) contributes to its own is defined as 1. After obtaining the S-values for all terms in \\(DAG_{A}\\), the semantic value of DO term A, \\(SV(A)\\), is calculated as: \\[SV(A)=\\displaystyle\\sum_{t \\in T_{A}} S_{A}(t)\\] Thus given two GO terms A and B, the semantic similarity between these two terms is defined as: \\[sim_{Wang}(A, B) = \\frac{\\displaystyle\\sum_{t \\in T_{A} \\cap T_{B}}{S_{A}(t) + S_{B}(t)}}{SV(A) + SV(B)}\\] where \\(S_{A}(\\textit{t})\\) is the S-value of GO term \\(t\\) related to term \\(A\\) and \\(S_{B}(\\textit{t})\\) is the S-value of GO term \\(t\\) related to term \\(B\\). This method proposed by Wang (Wang et al. 2007) determines the semantic similarity of two GO terms based on both the locations of these terms in the GO graph and their relations with their ancestor terms. 1.3 Combine methods Since a gene product can be annotated by multiple GO terms, semantic similarity among gene products needs to be aggregated from different semantic similarity scores of multiple GO terms associated with genes, including max, avg, rcmax and BMA. 1.3.1 max The max method calculates the maximum semantic similarity score over all pairs of GO terms between these two GO term sets. \\[sim_{max}(g_1, g_2) = \\displaystyle\\max_{1 \\le i \\le m, 1 \\le j \\le n} sim(go_{1i}, go_{2j})\\] 1.3.2 avg The avg calculates the average semantic similarity score over all pairs of GO terms. \\[sim_{avg}(g_1, g_2) = \\frac{\\displaystyle\\sum_{i=1}^m\\sum_{j=1}^nsim(go_{1i}, go_{2j})}{m \\times n}\\] 1.3.3 rcmax Similarities among two sets of GO terms form a matrix, the rcmax method uses the maximum of RowScore and ColumnScore, where RowScore (or ColumnScore) is the average of maximum similarity on each row (or column). \\[sim_{rcmax}(g_1, g_2) = \\max(\\frac{\\displaystyle\\sum_{i=1}^m \\max_{1 \\le j \\le n} sim(go_{1i}, go_{2j})}{m},\\frac{\\displaystyle\\sum_{j=1}^n \\max_{1 \\le i \\le m} sim(go_{1i},go_{2j})}{n})\\] 1.3.4 BMA The BMA method, used the Best-Match Average strategy, calculates the average of all maximum similarities on each row and column, and is defined as: \\[sim_{BMA}(g_1, g_2) = \\frac{\\displaystyle\\sum_{1=i}^m \\max_{1 \\le j \\le n}sim(go_{1i}, go_{2j}) + \\displaystyle\\sum_{1=j}^n \\max_{1 \\le i \\le m}sim(go_{1i}, go_{2j})} {m+n}\\] 1.4 Summary The idea behind semantic similarity measurement is the notion that genes with similar function should have similar annotation vocabulary and have a close relationship in the ontology strucutre. Measuring similarity is critical for expanding knownledge, since similar objects tend to behave similarly, which supports many bioinformatics applications to infer gene/protein functions, miRNA function, genetic interaction, protein-protein interaction, miRNA-mRNA interaction and celluar localization. We developed several Bioconductor packages, including GOSemSim (Yu et al. 2010; Yu 2020) for computing semantic similarity among GO terms, sets of GO terms, gene products and gene clusters (see also Chapter 2), DOSE (G. Yu et al. 2015) for Disease Ontology (DO) (see also Chapter 3) and meshes (Yu 2018) that based on Medical Subject Headings (MeSH) (see also Chapter 4). References "],
["GOSemSim.html", "Chapter 2 GO semantic similarity analysis 2.1 Semantic data 2.2 Supported organisms 2.3 GO semantic similarity measurement 2.4 Gene semantic similarity measurement 2.5 Gene cluster semantic similarity measurement", " Chapter 2 GO semantic similarity analysis GOSemSim implemented all methods described in Chapter 1, including four IC-based methods and one graph-based method. 2.1 Semantic data To measure semantic similarity, we need to prepare GO annotations including GO structure (i.e.¬†GO term relationships) and gene to GO mapping. For IC-based methods, information of GO term is species specific. We need to calculate IC for all GO terms of a species before we measure semantic similarity. GOSemSim provides the godata() function to prepare semantic data to support measuring GO and gene simiarlity. It internally used the GO.db package to obtain GO strucuture and OrgDb for gene to GO mapping. library(GOSemSim) hsGO &lt;- godata(&#39;org.Hs.eg.db&#39;, ont=&quot;MF&quot;) User can set computeIC=FALSE if they only want to use Wang‚Äôs method. 2.2 Supported organisms GOSemSim supports all organisms that have an OrgDb object available. Bioconductor have already provided OrgDb for about 20 species. We can query OrgDb online via the AnnotationHub package. For example: library(AnnotationHub) hub &lt;- AnnotationHub() q &lt;- query(hub, &quot;Cricetulus&quot;) id &lt;- q$ah_id[length(q)] Cgriseus &lt;- hub[[id]] If an organism is not supported by AnnotationHub, user can use the AnnotationForge package to build OrgDb manually. Once we have OrgDb, we can build annotation data needed by GOSemSim via godata() function described previously. 2.3 GO semantic similarity measurement The goSim() function calculates semantic similarity between two GO terms, while the mgoSim() function calculates semantic similarity between two sets of GO terms. goSim(&quot;GO:0004022&quot;, &quot;GO:0005515&quot;, semData=hsGO, measure=&quot;Jiang&quot;) ## [1] 0.159 goSim(&quot;GO:0004022&quot;, &quot;GO:0005515&quot;, semData=hsGO, measure=&quot;Wang&quot;) ## [1] 0.158 go1 = c(&quot;GO:0004022&quot;,&quot;GO:0004024&quot;,&quot;GO:0004174&quot;) go2 = c(&quot;GO:0009055&quot;,&quot;GO:0005515&quot;) mgoSim(go1, go2, semData=hsGO, measure=&quot;Wang&quot;, combine=NULL) ## GO:0009055 GO:0005515 ## GO:0004022 0.205 0.158 ## GO:0004024 0.185 0.141 ## GO:0004174 0.205 0.158 mgoSim(go1, go2, semData=hsGO, measure=&quot;Wang&quot;, combine=&quot;BMA&quot;) ## [1] 0.192 2.4 Gene semantic similarity measurement On the basis of semantic similarity between GO terms, GOSemSim can also compute semantic similarity among sets of GO terms, gene products, and gene clusters. Suppose we have gene \\(g_1\\) annotated by GO terms sets \\(GO_{1}=\\{go_{11},go_{12} \\cdots go_{1m}\\}\\) and \\(g_2\\) annotated by \\(GO_{2}=\\{go_{21},go_{22} \\cdots go_{2n}\\}\\), GOSemSim implemented four combine methods, including max, avg, rcmax, and BMA, to aggregate semantic similarity scores of multiple GO terms (see also session 1.3). The similarities among gene products and gene clusters which annotated by multiple GO terms are also calculated by the these combine methods. GOSemSim provides geneSim() to calculate semantic similarity between two gene products, and mgeneSim() to calculate semantic similarity among multiple gene products. geneSim(&quot;241&quot;, &quot;251&quot;, semData=hsGO, measure=&quot;Wang&quot;, combine=&quot;BMA&quot;) ## $geneSim ## [1] 0.207 ## ## $GO1 ## [1] &quot;GO:0004364&quot; &quot;GO:0004464&quot; &quot;GO:0004602&quot; &quot;GO:0005515&quot; &quot;GO:0047485&quot; ## [6] &quot;GO:0050544&quot; ## ## $GO2 ## [1] &quot;GO:0004035&quot; mgeneSim(genes=c(&quot;835&quot;, &quot;5261&quot;,&quot;241&quot;, &quot;994&quot;), semData=hsGO, measure=&quot;Wang&quot;,verbose=FALSE) ## 835 5261 241 994 ## 835 1.000 0.499 0.531 0.604 ## 5261 0.499 1.000 0.478 0.420 ## 241 0.531 0.478 1.000 0.462 ## 994 0.604 0.420 0.462 1.000 mgeneSim(genes=c(&quot;835&quot;, &quot;5261&quot;,&quot;241&quot;, &quot;994&quot;), semData=hsGO, measure=&quot;Rel&quot;,verbose=FALSE) ## 835 5261 241 994 ## 835 0.928 0.305 0.276 0.502 ## 5261 0.305 0.939 0.322 0.317 ## 241 0.276 0.322 0.941 0.277 ## 994 0.502 0.317 0.277 0.908 By default, godata function use ENTREZID as keytype, and the input ID type is ENTREZID. User can use other ID types such as ENSEMBL, UNIPROT, REFSEQ, ACCNUM, SYMBOL et al. Here as an example, we use SYMBOL as keytype and calculate semantic similarities among several genes by using their gene symbol as input. hsGO2 &lt;- godata(&#39;org.Hs.eg.db&#39;, keytype = &quot;SYMBOL&quot;, ont=&quot;MF&quot;, computeIC=FALSE) genes &lt;- c(&quot;CDC45&quot;, &quot;MCM10&quot;, &quot;CDC20&quot;, &quot;NMU&quot;, &quot;MMP1&quot;) mgeneSim(genes, semData=hsGO2, measure=&quot;Wang&quot;, combine=&quot;BMA&quot;, verbose=FALSE) ## CDC45 MCM10 CDC20 NMU MMP1 ## CDC45 1.000 0.817 0.601 0.551 0.150 ## MCM10 0.817 1.000 0.669 0.606 0.114 ## CDC20 0.601 0.669 1.000 0.746 0.136 ## NMU 0.551 0.606 0.746 1.000 0.112 ## MMP1 0.150 0.114 0.136 0.112 1.000 Users can also use clusterProfiler::bitr to translate biological IDs. 2.5 Gene cluster semantic similarity measurement GOSemSim also supports calculating semantic similarity between two gene clusters using clusterSim() function and measuring semantic similarity among multiple gene clusters using mclusterSim() function. gs1 &lt;- c(&quot;835&quot;, &quot;5261&quot;,&quot;241&quot;, &quot;994&quot;, &quot;514&quot;, &quot;533&quot;) gs2 &lt;- c(&quot;578&quot;,&quot;582&quot;, &quot;400&quot;, &quot;409&quot;, &quot;411&quot;) clusterSim(gs1, gs2, semData=hsGO, measure=&quot;Wang&quot;, combine=&quot;BMA&quot;) ## [1] 0.638 library(org.Hs.eg.db) x &lt;- org.Hs.egGO hsEG &lt;- mappedkeys(x) set.seed &lt;- 123 clusters &lt;- list(a=sample(hsEG, 20), b=sample(hsEG, 20), c=sample(hsEG, 20)) mclusterSim(clusters, semData=hsGO, measure=&quot;Wang&quot;, combine=&quot;BMA&quot;) ## a b c ## a 1.000 0.725 0.608 ## b 0.725 1.000 0.668 ## c 0.608 0.668 1.000 "],
["DOSE-semantic-similarity.html", "Chapter 3 DO semantic similarity analysis 3.1 DO term semantic similarity measurement 3.2 Gene semantic similarity measurement 3.3 Gene cluster semantic similarity measurement", " Chapter 3 DO semantic similarity analysis Public health is an important driving force behind biological and medical research. A major challenge of the post-genomic era is bridging the gap between fundamental biological research and its clinical applications. Recent research has increasingly demonstrated that many seemingly dissimilar diseases have common molecular mechanisms. Understanding similarities among disease aids in early diagnosis and new drug development. Formal knowledge representation of gene-disease association is demanded for this purpose. Ontologies, such as Gene Ontology (GO), have been successfully applied to represent biological knowledge, and many related techniques have been adopted to extract information. Disease Ontology (DO) (Schriml et al. 2011) was developed to create a consistent description of gene products with disease perspectives, and is essential for supporting functional genomics in disease context. Accurate disease descriptions can discover new relationships between genes and disease, and new functions for previous uncharacteried genes and alleles. Unlike other clinical vocabularies that defined disease related concepts disparately, DO is organized as a directed acyclic graph, laying the foundation for quantitative computation of disease knowledge. We developed an R package DOSE (G. Yu et al. 2015) for analyzing semantic similarities among DO terms and gene products annotated with DO terms. 3.1 DO term semantic similarity measurement Four methods determine the semantic similarity of two terms based on the Information Content of their common ancestor term were proposed by Resnik (Philip 1999), Jiang (Jiang and Conrath 1997), Lin (Lin 1998) and Schlicker (Schlicker et al. 2006). Wang (Wang et al. 2007) presented a method to measure the similarity based on the graph structure. Each of these methods has its own advantage and weakness. DOSE supports all these methods to compute semantic similarity among DO terms and gene products. For algorithm details, please refer to chapter 1. In DOSE, we implemented doSim for calculating semantic similarity between two DO terms and two set of DO terms. library(DOSE) a &lt;- c(&quot;DOID:14095&quot;, &quot;DOID:5844&quot;, &quot;DOID:2044&quot;, &quot;DOID:8432&quot;, &quot;DOID:9146&quot;, &quot;DOID:10588&quot;, &quot;DOID:3209&quot;, &quot;DOID:848&quot;, &quot;DOID:3341&quot;, &quot;DOID:252&quot;) b &lt;- c(&quot;DOID:9409&quot;, &quot;DOID:2491&quot;, &quot;DOID:4467&quot;, &quot;DOID:3498&quot;, &quot;DOID:11256&quot;) doSim(a[1], b[1], measure=&quot;Wang&quot;) ## [1] 0.07142995 doSim(a[1], b[1], measure=&quot;Resnik&quot;) ## [1] 0 doSim(a[1], b[1], measure=&quot;Lin&quot;) ## [1] 0 s &lt;- doSim(a, b, measure=&quot;Wang&quot;) s ## DOID:9409 DOID:2491 DOID:4467 DOID:3498 DOID:11256 ## DOID:14095 0.07142995 0.05714393 0.03676194 0.03676194 0.52749870 ## DOID:5844 0.14897652 0.11564838 0.02801328 0.02801328 0.06134327 ## DOID:2044 0.14897652 0.11564838 0.02801328 0.02801328 0.06134327 ## DOID:8432 0.17347273 0.13877811 0.03676194 0.03676194 0.07142995 ## DOID:9146 0.07142995 0.05714393 0.03676194 0.03676194 0.17347273 ## DOID:10588 0.13240905 0.18401515 0.02208240 0.02208240 0.05452137 ## DOID:3209 0.14897652 0.11564838 0.02801328 0.02801328 0.06134327 ## DOID:848 0.14897652 0.11564838 0.02801328 0.02801328 0.06134327 ## DOID:3341 0.13240905 0.09998997 0.02208240 0.02208240 0.05452137 ## DOID:252 0.06134327 0.04761992 0.02801328 0.02801328 0.06134327 The doSim function requires three parameter DOID1, DOID2 and measure. DOID1 and DOID2 should be a vector of DO terms, while measure should be one of Resnik, Jiang, Lin, Rel, and Wang. We also implement a plot function simplot() to visualize the similarity result as demonstrated in Figure 3.1. simplot(s, color.low=&quot;white&quot;, color.high=&quot;red&quot;, labs=TRUE, digits=2, labs.size=5, font.size=14, xlab=&quot;&quot;, ylab=&quot;&quot;) Figure 3.1: Similarity matrix visualization. The simplot() function visualize similarity matrix as a heatmap. Parameter color.low and colow.high are used to setting the color gradient; labs is a logical parameter indicating whether to show the similarity values or not, digits to indicate the number of decimal places to be used and labs.size control the font size of similarity values; font.size setting the font size of axis and label of the coordinate system. 3.2 Gene semantic similarity measurement On the basis of semantic similarity between DO terms, DOSE can also compute semantic similarity among gene products. DOSE provides four methods which called max, avg, rcmax and BMA to combine semantic similarity scores of multiple DO terms (as described in session 1.3). The similarities among genes and gene clusters which annotated by multiple DO terms were also calculated by these combine methods. DOSE implemented geneSim to measure semantic similarities among genes. g1 &lt;- c(&quot;84842&quot;, &quot;2524&quot;, &quot;10590&quot;, &quot;3070&quot;, &quot;91746&quot;) g2 &lt;- c(&quot;84289&quot;, &quot;6045&quot;, &quot;56999&quot;, &quot;9869&quot;) geneSim(g1[1], g2[1], measure=&quot;Wang&quot;, combine=&quot;BMA&quot;) ## [1] 0.051 gs &lt;- geneSim(g1, g2, measure=&quot;Wang&quot;, combine=&quot;BMA&quot;) gs ## 84289 6045 56999 9869 ## 84842 0.051 0.135 0.355 0.103 ## 2524 0.284 0.172 0.517 0.517 ## 10590 0.150 0.173 0.242 0.262 ## 3070 0.573 0.517 1.000 1.000 ## 91746 0.351 0.308 0.527 0.496 The geneSim requires four parameter geneID1, geneID2, measure and combine. geneID1 and geneID2 should be a vector of entrez gene IDs; measure should be one of Resnik, Jiang, Lin, Rel, and Wang, while combine should be one of max, avg, rcmax and BMA. 3.3 Gene cluster semantic similarity measurement DOSE also implemented clusterSim for calculating semantic similarity between two gene clusters and mclusterSim for calculating semantic similarities among multiple gene clusters. clusterSim(g1, g2, measure=&quot;Wang&quot;, combine=&quot;BMA&quot;) ## [1] 0.549 g3 &lt;- c(&quot;57491&quot;, &quot;6296&quot;, &quot;51438&quot;, &quot;5504&quot;, &quot;27319&quot;, &quot;1643&quot;) clusters &lt;- list(a=g1, b=g2, c=g3) mclusterSim(clusters, measure=&quot;Wang&quot;, combine=&quot;BMA&quot;) ## a b c ## a 1.000 0.549 0.425 ## b 0.549 1.000 0.645 ## c 0.425 0.645 1.000 References "],
["meshes-semantic-similarity.html", "Chapter 4 MeSH semantic similarity analysis 4.1 Supported organisms 4.2 MeSH semantic similarity measurement 4.3 Gene semantic similarity measurement", " Chapter 4 MeSH semantic similarity analysis MeSH (Medical Subject Headings) is the NLM (U.S. National Library of Medicine) controlled vocabulary used to manually index articles for MEDLINE/PubMed. MeSH is a comprehensive life science vocabulary. MeSH has 19 categories and MeSH.db contains 16 of them. That is: Abbreviation Category A Anatomy B Organisms C Diseases D Chemicals and Drugs E Analytical, Diagnostic and Therapeutic Techniques and Equipment F Psychiatry and Psychology G Phenomena and Processes H Disciplines and Occupations I Anthropology, Education, Sociology and Social Phenomena J Technology and Food and Beverages K Humanities L Information Science M Persons N Health Care V Publication Type Z Geographical Locations MeSH terms were associated with Entrez Gene ID by three methods, gendoo, gene2pubmed and RBBH (Reciprocal Blast Best Hit). Method Way of corresponding Entrez Gene IDs and MeSH IDs Gendoo Text-mining gene2pubmed Manual curation by NCBI teams RBBH sequence homology with BLASTP search (E-value&lt;10-50) 4.1 Supported organisms The meshes relies on MeSHDb to prepare semantic data for measuring simiarlity. A list of MeSHDb can be found on Bioconductor, https://bioconductor.org/packages/release/BiocViews.html#___MeSHDb and all the species (more than 70) that have MeSHDb available are supported by the meshes package. The semantic data is prepare by the meshdata() function: hsamd &lt;- meshdata(&quot;MeSH.Hsa.eg.db&quot;, category=&#39;A&#39;, computeIC=T, database=&quot;gendoo&quot;) ## you may want to save the result for future usage # # save(hsamd, file = &quot;hsamd.rda&quot;) # 4.2 MeSH semantic similarity measurement The meshes package implemented four IC-based methods (i.e.¬†Resnik (Philip 1999), Jiang (Jiang and Conrath 1997), Lin (Lin 1998) and Schlicker (Schlicker et al. 2006)) and one graph-structure based method (i.e.¬†Wang (Wang et al. 2007)), to measure MeSH term semantic similarity. For algorithm details, please refer to Chapter 1. The meshSim() function is designed to measure semantic similarity between two MeSH term vectors. library(meshes) meshSim(&quot;D000009&quot;, &quot;D009130&quot;, semData=hsamd, measure=&quot;Resnik&quot;) ## [1] 0.2910261 meshSim(&quot;D000009&quot;, &quot;D009130&quot;, semData=hsamd, measure=&quot;Rel&quot;) ## [1] 0.521396 meshSim(&quot;D000009&quot;, &quot;D009130&quot;, semData=hsamd, measure=&quot;Jiang&quot;) ## [1] 0.4914785 meshSim(&quot;D000009&quot;, &quot;D009130&quot;, semData=hsamd, measure=&quot;Wang&quot;) ## [1] 0.5557103 meshSim(c(&quot;D001369&quot;, &quot;D002462&quot;), c(&quot;D017629&quot;, &quot;D002890&quot;, &quot;D008928&quot;), semData=hsamd, measure=&quot;Wang&quot;) ## D017629 D002890 D008928 ## D001369 0.2886598 0.1923711 0.2193326 ## D002462 0.6521739 0.2381925 0.2809552 4.3 Gene semantic similarity measurement The geneSim() function is designed to measure semantic similarity among two gene vectors. geneSim(&quot;241&quot;, &quot;251&quot;, semData=hsamd, measure=&quot;Wang&quot;, combine=&quot;BMA&quot;) ## [1] 0.487 geneSim(c(&quot;241&quot;, &quot;251&quot;), c(&quot;835&quot;, &quot;5261&quot;,&quot;241&quot;, &quot;994&quot;), semData=hsamd, measure=&quot;Wang&quot;, combine=&quot;BMA&quot;) ## 835 5261 241 994 ## 241 0.732 0.337 1.000 0.438 ## 251 0.526 0.588 0.487 0.597 References "],
["enrichment-overview.html", "Chapter 5 Overview of enrichment analysis 5.1 Terminology 5.2 Over Representation Analysis 5.3 Gene Set Enrichment Analysis 5.4 Leading edge analysis and core enriched genes", " Chapter 5 Overview of enrichment analysis 5.1 Terminology 5.1.1 Gene sets and pathway A gene set is an unordered collection of genes that are functional related. A pathway can be interpreted as a gene set by ignoring functional relationships among genes. 5.1.2 Gene Ontology (GO) Gene Ontology defines concepts/classes used to describe gene function, and relationships between these concepts. It classifies functions along three aspects: MF: Molecular Function molecular activities of gene products CC: Cellular Component where gene products are active BP: Biological Process pathways and larger processes made up of the activities of multiple gene products GO terms are organized in a directed acyclic graph, where edge between the terms represent parent-child relationship. 5.1.3 Kyoto Encyclopedia of Genes and Genomes (KEGG) KEGG is a collection of manually drawn pathway maps representing molecular interaction and reaction networks. These pathways cover a wide range of biochemical processes that can be divided in 7 broad categories: Metabolism Genetic information processing Environmental information processing Cellular processes Organismal systems Human diseases Drug development. 5.1.4 Other gene sets GO and KEGG are most frequently used for the functional analysis. They are typically the first choice because their long-standing curation and availability for a wide range of species. Other gene sets including but not limited to Disease Ontology (DO), Disease Gene Network (DisGeNET), wikiPathways, Molecular Signatures Database (MSigDb). 5.2 Over Representation Analysis Over Representation Analysis (ORA) (Boyle et al. 2004) is a widely used approach to determine whether known biological functions or processes are over-represented (= enriched) in an experimentally-derived gene list, e.g. a list of differentially expressed genes (DEGs). The p-value can be calculated by hypergeometric distribution. \\(p = 1 - \\displaystyle\\sum_{i = 0}^{k-1}\\frac{{M \\choose i}{{N-M} \\choose {n-i}}} {{N \\choose n}}\\) In this equation, N is the total number of genes in the background distribution, M is the number of genes within that distribution that are annotated (either directly or indirectly) to the gene set of interest, n is the size of the list of genes of interest and k is the number of genes within that list which are annotated to the gene set. The background distribution by default is all the genes that have annotation. P-values should be adjusted for multiple comparison. Example: Suppose we have 17,980 genes detected in a Microarray study and 57 genes were differentially expressed. Among the differential expressed genes, 28 are annotated to a gene set1. d &lt;- data.frame(gene.not.interest=c(2613, 15310), gene.in.interest=c(28, 29)) row.names(d) &lt;- c(&quot;In_category&quot;, &quot;not_in_category&quot;) d ## gene.not.interest gene.in.interest ## In_category 2613 28 ## not_in_category 15310 29 whether the overlap of 25 genes are significantly over represented in the gene set can be assessed using hypergeometric distribution. This corresponding to a one-sided version of Fisher‚Äôs exact test. fisher.test(d, alternative = &quot;greater&quot;) ## ## Fisher&#39;s Exact Test for Count Data ## ## data: d ## p-value = 1 ## alternative hypothesis: true odds ratio is greater than 1 ## 95 percent confidence interval: ## 0.110242 Inf ## sample estimates: ## odds ratio ## 0.1767937 5.3 Gene Set Enrichment Analysis A common approach in analyzing gene expression profiles was identifying differential expressed genes that are deemed interesting. The ORA enrichment analysis is based on these differential expressed genes. This approach will find genes where the difference is large, but it will not detect a situation where the difference is small, but evidenced in coordinated way in a set of related genes. Gene Set Enrichment Analysis (GSEA)(Subramanian et al. 2005) directly addresses this limitation. All genes can be used in GSEA; GSEA aggregates the per gene statistics across genes within a gene set, therefore making it possible to detect situations where all genes in a predefined set change in a small but coordinated way. Since it is likely that many relevant phenotypic differences are manifested by small but consistent changes in a set of genes. Genes are ranked based on their phenotypes. Given a priori defined set of gene S (e.g., genes shareing the same DO category), the goal of GSEA is to determine whether the members of S are randomly distributed throughout the ranked gene list (L) or primarily found at the top or bottom. There are three key elements of the GSEA method: Calculation of an Enrichment Score. The enrichment score (ES) represent the degree to which a set S is over-represented at the top or bottom of the ranked list L. The score is calculated by walking down the list L, increasing a running-sum statistic when we encounter a gene in S and decreasing when it is not. The magnitude of the increment depends on the gene statistics (e.g., correlation of the gene with phenotype). The ES is the maximum deviation from zero encountered in the random walk; it corresponds to a weighted Kolmogorov-Smirnov-like statistic (Subramanian et al. 2005). Esimation of Significance Level of ES. The p-value of the ES is calculated using permutation test. Specifically, we permute the gene labels of the gene list L and recompute the ES of the gene set for the permutated data, which generate a null distribution for the ES. The p-value of the observed ES is then calculated relative to this null distribution. Adjustment for Multiple Hypothesis Testing. When the entire gene sets were evaluated, the estimated significance level was adjusted to account for multiple hypothesis testing and also q-values were calculated for FDR control. We implemented GSEA algorithm proposed by Subramanian (Subramanian et al. 2005). Alexey Sergushichev implemented an algorithm for fast GSEA calculation in the fgsea (Korotkevich, Sukhov, and Sergushichev 2019) package. In our packages (clusterProfiler, DOSE, meshes and ReactomePA), users can use GSEA algorithm implemented in DOSE or fgsea by specifying the parameter by=\"DOSE\" or by=\"fgsea\". By default, the fgsea method will be used since it is much more faster. 5.4 Leading edge analysis and core enriched genes Leading edge analysis reports Tags to indicate the percentage of genes contributing to the enrichment score, List to indicate where in the list the enrichment score is attained and Signal for enrichment signal strength. It would also be very interesting to get the core enriched genes that contribute to the enrichment. Our packages (clusterProfiler, DOSE, meshes and ReactomePA) support leading edge analysis and report core enriched genes in GSEA analysis. References "],
["clusterprofiler-go.html", "Chapter 6 GO enrichment analysis 6.1 Supported organisms 6.2 GO classification 6.3 GO over-representation test 6.4 GO Gene Set Enrichment Analysis 6.5 GO analysis for non-model organisms 6.6 Summary", " Chapter 6 GO enrichment analysis GO comprises of three orthogonal ontologies, i.e.¬†molecular function (MF), biological process (BP), and cellular component (CC). 6.1 Supported organisms GO analyses (groupGO(), enrichGO() and gseGO()) support organisms that have an OrgDb object available (see also session 2.2). If user have GO annotation data (in data.frame format with first column of gene ID and second column of GO ID), they can use enricher() and gseGO() functions to perform over-representation test and gene set enrichment analysis. If genes are annotated by direction annotation, it should also annotated by its ancestor GO nodes (indirect annation). If user only has direct annotation, they can pass their annotation to buildGOmap function, which will infer indirection annotation and generate a data.frame that suitable for both enricher() and gseGO(). 6.2 GO classification In clusterProfiler, the groupGO() is designed for gene classification based on GO distribution at a specific level. Here we use the dataset geneList provided by DOSE. library(clusterProfiler) data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] # Entrez gene ID head(gene) ## [1] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; &quot;991&quot; ggo &lt;- groupGO(gene = gene, OrgDb = org.Hs.eg.db, ont = &quot;CC&quot;, level = 3, readable = TRUE) head(ggo) ## ID Description Count ## GO:0000131 GO:0000131 incipient cellular bud site 0 ## GO:0000151 GO:0000151 ubiquitin ligase complex 4 ## GO:0000159 GO:0000159 protein phosphatase type 2A complex 0 ## GO:0000178 GO:0000178 exosome (RNase complex) 0 ## GO:0000307 GO:0000307 cyclin-dependent protein kinase holoenzyme complex 4 ## GO:0000408 GO:0000408 EKC/KEOPS complex 0 ## GeneRatio geneID ## GO:0000131 0/207 ## GO:0000151 4/207 CDC20/UBE2C/UBE2S/DTL ## GO:0000159 0/207 ## GO:0000178 0/207 ## GO:0000307 4/207 CCNB2/CCNA2/CDK1/CCNB1 ## GO:0000408 0/207 The gene parameter is a vector of gene IDs (can be any ID type that supported by corresponding OrgDb, see also session 16.1). If readable is set to TRUE, the input gene IDs will be converted to gene symbols. 6.3 GO over-representation test The clusterProfiler package implemented enrichGO() function for gene ontology over-representation test. ego &lt;- enrichGO(gene = gene, universe = names(geneList), OrgDb = org.Hs.eg.db, ont = &quot;CC&quot;, pAdjustMethod = &quot;BH&quot;, pvalueCutoff = 0.01, qvalueCutoff = 0.05, readable = TRUE) head(ego) ## ID Description GeneRatio ## GO:0005819 GO:0005819 spindle 25/200 ## GO:0005876 GO:0005876 spindle microtubule 12/200 ## GO:0000779 GO:0000779 condensed chromosome, centromeric region 15/200 ## GO:0072686 GO:0072686 mitotic spindle 15/200 ## GO:0000775 GO:0000775 chromosome, centromeric region 18/200 ## GO:0000776 GO:0000776 kinetochore 15/200 ## BgRatio pvalue p.adjust qvalue ## GO:0005819 272/11816 4.695505e-12 1.441520e-09 1.324627e-09 ## GO:0005876 48/11816 1.623758e-11 2.492469e-09 2.290354e-09 ## GO:0000779 91/11816 2.808998e-11 2.537981e-09 2.332175e-09 ## GO:0072686 92/11816 3.306816e-11 2.537981e-09 2.332175e-09 ## GO:0000775 154/11816 1.061302e-10 6.516397e-09 5.987980e-09 ## GO:0000776 107/11816 3.047081e-10 1.559090e-08 1.432663e-08 ## geneID ## GO:0005819 CDCA8/CDC20/KIF23/CENPE/ASPM/DLGAP5/SKA1/NUSAP1/TPX2/TACC3/NEK2/CDK1/MAD2L1/KIF18A/BIRC5/KIF11/TTK/AURKB/PRC1/KIFC1/KIF18B/KIF20A/AURKA/CCNB1/KIF4A ## GO:0005876 CENPE/SKA1/NUSAP1/CDK1/KIF18A/BIRC5/KIF11/AURKB/PRC1/KIF18B/AURKA/KIF4A ## GO:0000779 CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/CDT1/BIRC5/NCAPG/AURKB/AURKA/CCNB1 ## GO:0072686 KIF23/CENPE/ASPM/SKA1/NUSAP1/TPX2/TACC3/CDK1/MAD2L1/KIF18A/KIF11/AURKB/KIFC1/KIF18B/AURKA ## GO:0000775 CDCA8/CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/NCAPG/AURKB/AURKA/CCNB1 ## GO:0000776 CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/CDT1/BIRC5/TTK/AURKB/CCNB1 ## Count ## GO:0005819 25 ## GO:0005876 12 ## GO:0000779 15 ## GO:0072686 15 ## GO:0000775 18 ## GO:0000776 15 Any gene ID type that supported in OrgDb can be directly used in GO analyses. User need to specify the keyType parameter to specify the input gene ID type. gene.df &lt;- bitr(gene, fromType = &quot;ENTREZID&quot;, toType = c(&quot;ENSEMBL&quot;, &quot;SYMBOL&quot;), OrgDb = org.Hs.eg.db) ego2 &lt;- enrichGO(gene = gene.df$ENSEMBL, OrgDb = org.Hs.eg.db, keyType = &#39;ENSEMBL&#39;, ont = &quot;CC&quot;, pAdjustMethod = &quot;BH&quot;, pvalueCutoff = 0.01, qvalueCutoff = 0.05) head(ego2, 3) ## ID Description GeneRatio BgRatio pvalue ## GO:0072686 GO:0072686 mitotic spindle 19/233 124/21659 8.062390e-17 ## GO:0005819 GO:0005819 spindle 29/233 374/21659 8.726108e-17 ## GO:0005876 GO:0005876 spindle microtubule 13/233 61/21659 7.682630e-14 ## p.adjust qvalue ## GO:0072686 1.282738e-14 9.690572e-15 ## GO:0005819 1.282738e-14 9.690572e-15 ## GO:0005876 7.528978e-12 5.687842e-12 ## geneID ## GO:0072686 ENSG00000137807/ENSG00000138778/ENSG00000066279/ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000088325/ENSG00000013810/ENSG00000170312/ENSG00000164109/ENSG00000121621/ENSG00000138160/ENSG00000178999/ENSG00000237649/ENSG00000233450/ENSG00000204197/ENSG00000056678/ENSG00000186185/ENSG00000087586 ## GO:0005819 ENSG00000134690/ENSG00000117399/ENSG00000137807/ENSG00000138778/ENSG00000066279/ENSG00000126787/ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000088325/ENSG00000013810/ENSG00000117650/ENSG00000170312/ENSG00000164109/ENSG00000121621/ENSG00000089685/ENSG00000138160/ENSG00000112742/ENSG00000178999/ENSG00000198901/ENSG00000237649/ENSG00000233450/ENSG00000204197/ENSG00000056678/ENSG00000186185/ENSG00000112984/ENSG00000087586/ENSG00000134057/ENSG00000090889 ## GO:0005876 ENSG00000138778/ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000170312/ENSG00000121621/ENSG00000089685/ENSG00000138160/ENSG00000178999/ENSG00000198901/ENSG00000186185/ENSG00000087586/ENSG00000090889 ## Count ## GO:0072686 19 ## GO:0005819 29 ## GO:0005876 13 Gene ID can be mapped to gene Symbol by using paramter readable=TRUE or setReadable() function. 6.4 GO Gene Set Enrichment Analysis The clusterProfiler package provides gseGO() function for gene set enrichment analysis using gene ontology. ego3 &lt;- gseGO(geneList = geneList, OrgDb = org.Hs.eg.db, ont = &quot;CC&quot;, minGSSize = 100, maxGSSize = 500, pvalueCutoff = 0.05, verbose = FALSE) The format of input data, geneList, was documented in the FAQ. Beware that only gene Set size in [minGSSize, maxGSSize] will be tested. 6.5 GO analysis for non-model organisms Both enrichGO() and gseGO() functions require an OrgDb object as background annotation. For organisms that don‚Äôt have OrgDb provided by Bioconductor, users can query one (if available) online via AnnotationHub. If there is no OrgDb available, users can obtain GO annotation from other sources, e.g.¬†from biomaRt or Blast2GO. Then the enricher() or GSEA() functions can be used to perform GO analysis for these organisms, similar to the examples using wikiPathways and MSigDB. Another solution is to create OrgDb by your own using AnnotationForge package. 6.6 Summary GO semantic similarity can be calculated by GOSemSim (Yu et al. 2010). We can use it to cluster genes/proteins into different clusters based on their functional similarity and can also use it to measure the similarities among GO terms to reduce the redundancy of GO enrichment results. References "],
["clusterprofiler-kegg.html", "Chapter 7 KEGG enrichment analysis 7.1 Supported organisms 7.2 KEGG pathway over-representation test 7.3 KEGG pathway gene set enrichment analysis 7.4 KEGG module over-representation test 7.5 KEGG module gene set enrichment analysis", " Chapter 7 KEGG enrichment analysis The KEGG FTP service is not freely available for academic since 2012, and there are many software packages using out-dated KEGG annotation data. The clusterProfiler package supports downloading latest online version of KEGG data using the KEGG website, which is freely available for academic users. Both KEGG pathway and module are supported in clusterProfiler. 7.1 Supported organisms The clusterProfiler package supports all organisms that have KEGG annotation data available in KEGG database. User should pass abbreviation of academic name to the organism parameter. The full list of KEGG supported organisms can be accessed via http://www.genome.jp/kegg/catalog/org_list.html. KEGG Orthology (KO) Database is also supported by specifying organism = \"ko\". The clusterProfiler package provides search_kegg_organism() function to help searching supported organisms. library(clusterProfiler) search_kegg_organism(&#39;ece&#39;, by=&#39;kegg_code&#39;) ## kegg_code scientific_name common_name ## 366 ece Escherichia coli O157:H7 EDL933 (EHEC) &lt;NA&gt; ecoli &lt;- search_kegg_organism(&#39;Escherichia coli&#39;, by=&#39;scientific_name&#39;) dim(ecoli) ## [1] 65 3 head(ecoli) ## kegg_code scientific_name common_name ## 361 eco Escherichia coli K-12 MG1655 &lt;NA&gt; ## 362 ecj Escherichia coli K-12 W3110 &lt;NA&gt; ## 363 ecd Escherichia coli K-12 DH10B &lt;NA&gt; ## 364 ebw Escherichia coli BW2952 &lt;NA&gt; ## 365 ecok Escherichia coli K-12 MDS42 &lt;NA&gt; ## 366 ece Escherichia coli O157:H7 EDL933 (EHEC) &lt;NA&gt; 7.2 KEGG pathway over-representation test data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] kk &lt;- enrichKEGG(gene = gene, organism = &#39;hsa&#39;, pvalueCutoff = 0.05) head(kk) ## ID Description ## hsa04110 hsa04110 Cell cycle ## hsa04114 hsa04114 Oocyte meiosis ## hsa04218 hsa04218 Cellular senescence ## hsa04061 hsa04061 Viral protein interaction with cytokine and cytokine receptor ## hsa03320 hsa03320 PPAR signaling pathway ## hsa04914 hsa04914 Progesterone-mediated oocyte maturation ## GeneRatio BgRatio pvalue p.adjust qvalue ## hsa04110 11/94 124/8063 1.709528e-07 3.453247e-05 3.365071e-05 ## hsa04114 10/94 128/8063 2.089725e-06 2.110622e-04 2.056729e-04 ## hsa04218 10/94 156/8063 1.235106e-05 8.316384e-04 8.104032e-04 ## hsa04061 8/94 100/8063 1.952541e-05 9.860331e-04 9.608556e-04 ## hsa03320 7/94 77/8063 2.891619e-05 1.168214e-03 1.138385e-03 ## hsa04914 7/94 99/8063 1.453968e-04 4.895026e-03 4.770036e-03 ## geneID Count ## hsa04110 8318/991/9133/890/983/4085/7272/1111/891/4174/9232 11 ## hsa04114 991/9133/983/4085/51806/6790/891/9232/3708/5241 10 ## hsa04218 2305/4605/9133/890/983/51806/1111/891/776/3708 10 ## hsa04061 3627/10563/6373/4283/6362/6355/9547/1524 8 ## hsa03320 4312/9415/9370/5105/2167/3158/5346 7 ## hsa04914 9133/890/983/4085/6790/891/5241 7 Input ID type can be kegg, ncbi-geneid, ncbi-proteinid or uniprot (see also session 16.1.2). Unlike enrichGO(), there is no readable parameter for enrichKEGG(). However, users can use the setReadable() function if there is an OrgDb available for the species. 7.3 KEGG pathway gene set enrichment analysis kk2 &lt;- gseKEGG(geneList = geneList, organism = &#39;hsa&#39;, nPerm = 1000, minGSSize = 120, pvalueCutoff = 0.05, verbose = FALSE) head(kk2) ## ID Description setSize enrichmentScore NES ## hsa04151 hsa04151 PI3K-Akt signaling pathway 322 -0.3482755 -1.500870 ## hsa04510 hsa04510 Focal adhesion 190 -0.4169068 -1.704878 ## hsa03013 hsa03013 RNA transport 135 0.4103684 1.754986 ## hsa04218 hsa04218 Cellular senescence 141 0.4115945 1.773355 ## hsa05152 hsa05152 Tuberculosis 162 0.3745153 1.652657 ## hsa05203 hsa05203 Viral carcinogenesis 164 0.3523856 1.557636 ## pvalue p.adjust qvalues rank leading_edge ## hsa04151 0.001277139 0.02734375 0.01768092 1997 tags=23%, list=16%, signal=20% ## hsa04510 0.001356852 0.02734375 0.01768092 2183 tags=27%, list=17%, signal=22% ## hsa03013 0.003278689 0.02734375 0.01768092 3383 tags=39%, list=27%, signal=29% ## hsa04218 0.003289474 0.02734375 0.01768092 1155 tags=17%, list=9%, signal=16% ## hsa05152 0.003355705 0.02734375 0.01768092 2823 tags=34%, list=23%, signal=27% ## hsa05203 0.003367003 0.02734375 0.01768092 3112 tags=35%, list=25%, signal=26% ## core_enrichment ## hsa04151 627/2252/7059/92579/5563/5295/6794/1288/7010/3910/3371/3082/1291/4602/3791/1027/90993/3441/3643/1129/2322/1975/7450/596/3685/1942/2149/1280/4804/3675/595/2261/7248/2246/4803/3912/1902/1278/1277/2846/2057/1293/2247/55970/5618/7058/10161/56034/3693/4254/3480/4908/5159/1292/3908/2690/3909/8817/9223/4915/3551/2791/63923/3913/9863/3667/1287/3679/7060/3479/80310/1311/5105/2066/1101 ## hsa04510 5595/5228/7424/1499/4636/83660/7059/5295/1288/23396/3910/3371/3082/1291/394/3791/7450/596/3685/1280/3675/595/2318/3912/1793/1278/1277/1293/10398/55742/2317/7058/25759/56034/3693/3480/5159/857/1292/3908/3909/63923/3913/1287/3679/7060/3479/10451/80310/1311/1101 ## hsa03013 10460/1978/55110/54913/9688/8894/11260/10799/9631/4116/5042/8761/6396/23165/8662/10248/55706/79833/9775/29107/23636/5905/9513/5901/10775/10557/4927/79902/1981/26986/11171/10762/8480/8891/11097/26019/55308/10940/4686/9972/81929/10556/3646/9470/387082/1977/57122/8563/7514/79023/3837/9818/56000 ## hsa04218 2305/4605/9133/890/983/51806/1111/891/993/3576/1978/898/9134/4609/1869/1029/22808/1871/5499/91860/292/1019/11200/1875 ## hsa05152 820/51806/6772/64581/3126/3112/8767/3654/1054/1051/3458/1520/11151/1594/50617/54205/91860/8877/3329/637/3689/7096/2207/3929/4360/5603/929/533/3452/6850/7124/1509/3569/7097/1378/8772/64170/3119/843/2213/8625/3920/2215/3587/5594/3593/9103/3592/6300/9114/10333/3109/3108/1432/3552 ## hsa05203 991/890/983/1111/898/9134/6502/85236/1237/1029/8970/4067/2957/5902/55697/3066/578/1019/1234/8345/7534/5315/3018/468/6850/1030/4055/7186/1959/3135/5933/5610/1642/5594/9734/4792/5567/3134/23352/7185/10379/5366/4893/1232/2960/23513/9114/2958/10971/7533/9519/5568/836/1233/6714/3106/8379 7.4 KEGG module over-representation test KEGG Module is a collection of manually defined function units. In some situation, KEGG Modules have a more straightforward interpretation. mkk &lt;- enrichMKEGG(gene = gene, organism = &#39;hsa&#39;, pvalueCutoff = 1, qvalueCutoff = 1) head(mkk) ## ID ## M00095 M00095 ## M00053 M00053 ## M00003 M00003 ## M00049 M00049 ## Description ## M00095 C5 isoprenoid biosynthesis, mevalonate pathway ## M00053 Pyrimidine deoxyribonuleotide biosynthesis, CDP/CTP =&gt; dCDP/dCTP,dTDP/dTTP ## M00003 Gluconeogenesis, oxaloacetate =&gt; fructose-6P ## M00049 Adenine ribonucleotide biosynthesis, IMP =&gt; ADP,ATP ## GeneRatio BgRatio pvalue p.adjust qvalue geneID Count ## M00095 1/9 10/824 0.1045527 0.2171109 0.2171109 3158 1 ## M00053 1/9 14/824 0.1435736 0.2171109 0.2171109 6241 1 ## M00003 1/9 18/824 0.1810757 0.2171109 0.2171109 5105 1 ## M00049 1/9 22/824 0.2171109 0.2171109 0.2171109 26289 1 7.5 KEGG module gene set enrichment analysis mkk2 &lt;- gseMKEGG(geneList = geneList, organism = &#39;hsa&#39;, pvalueCutoff = 1) head(mkk2) ## ID ## M00001 M00001 ## M00035 M00035 ## M00053 M00053 ## M00002 M00002 ## M00009 M00009 ## M00104 M00104 ## Description ## M00001 Glycolysis (Embden-Meyerhof pathway), glucose =&gt; pyruvate ## M00035 Methionine degradation ## M00053 Pyrimidine deoxyribonuleotide biosynthesis, CDP/CTP =&gt; dCDP/dCTP,dTDP/dTTP ## M00002 Glycolysis, core module involving three-carbon compounds ## M00009 Citrate cycle (TCA cycle, Krebs cycle) ## M00104 Bile acid biosynthesis, cholesterol =&gt; cholate/chenodeoxycholate ## setSize enrichmentScore NES pvalue p.adjust qvalues rank ## M00001 24 0.5739036 1.761163 0.007506083 0.2401947 0.2212319 2886 ## M00035 10 0.6784636 1.635711 0.018802441 0.2862329 0.2636356 1555 ## M00053 10 0.6648004 1.602770 0.026834338 0.2862329 0.2636356 648 ## M00002 11 0.6421781 1.594902 0.036559118 0.2924729 0.2693830 1381 ## M00009 22 0.4504911 1.347220 0.118518519 0.7389091 0.6805742 3514 ## M00104 10 -0.5876900 -1.323981 0.140221402 0.7389091 0.6805742 961 ## leading_edge ## M00001 tags=54%, list=23%, signal=42% ## M00035 tags=50%, list=12%, signal=44% ## M00053 tags=40%, list=5%, signal=38% ## M00002 tags=55%, list=11%, signal=49% ## M00009 tags=50%, list=28%, signal=36% ## M00104 tags=50%, list=8%, signal=46% ## core_enrichment ## M00001 5214/3101/2821/7167/2597/5230/2023/5223/5315/3099/5232/2027/5211 ## M00035 875/1789/191/1788/1786 ## M00053 6241/7298/4830/1841 ## M00002 7167/2597/5230/2023/5223/5315 ## M00009 3418/50/4190/3419/2271/3421/55753/3417/1431/6389/4191 ## M00104 6342/10998/1581/3295/8309 "],
["reactomepa.html", "Chapter 8 Reactome enrichment analysis 8.1 Supported organisms 8.2 Reactome pathway over-representation test 8.3 Reactome pathway gene set enrichment analysis 8.4 Pathway Visualization", " Chapter 8 Reactome enrichment analysis ReactomePA is designed for reactome pathway based analysis (Yu and He 2016). Reactome is an open-source, open access, manually curated and peer-reviewed pathway database. 8.1 Supported organisms Currently ReactomePA supports several model organisms, including ‚Äòcelegans‚Äô, ‚Äòfly‚Äô, ‚Äòhuman‚Äô, ‚Äòmouse‚Äô, ‚Äòrat‚Äô, ‚Äòyeast‚Äô and ‚Äòzebrafish‚Äô. The input gene ID should be Entrez gene ID. We recommend using clusterProfiler::bitr() to convert biological IDs. 8.2 Reactome pathway over-representation test Enrichment analysis is a widely used approach to identify biological themes. ReactomePA implemented enrichPathway() that uses hypergeometric model to assess whether the number of selected genes associated with a reactome pathway is larger than expected. library(ReactomePA) data(geneList) de &lt;- names(geneList)[abs(geneList) &gt; 1.5] head(de) ## [1] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; &quot;991&quot; x &lt;- enrichPathway(gene=de, pvalueCutoff = 0.05, readable=TRUE) head(x) ## ID ## R-HSA-69620 R-HSA-69620 ## R-HSA-2500257 R-HSA-2500257 ## R-HSA-141424 R-HSA-141424 ## R-HSA-141444 R-HSA-141444 ## R-HSA-69618 R-HSA-69618 ## R-HSA-68877 R-HSA-68877 ## Description ## R-HSA-69620 Cell Cycle Checkpoints ## R-HSA-2500257 Resolution of Sister Chromatid Cohesion ## R-HSA-141424 Amplification of signal from the kinetochores ## R-HSA-141444 Amplification of signal from unattached kinetochores via a MAD2 inhibitory signal ## R-HSA-69618 Mitotic Spindle Checkpoint ## R-HSA-68877 Mitotic Prometaphase ## GeneRatio BgRatio pvalue p.adjust qvalue ## R-HSA-69620 37/322 293/10654 9.962958e-14 7.173330e-11 6.355319e-11 ## R-HSA-2500257 23/322 126/10654 2.824834e-12 1.016940e-09 9.009735e-10 ## R-HSA-141424 20/322 96/10654 6.054136e-12 1.089744e-09 9.654753e-10 ## R-HSA-141444 20/322 96/10654 6.054136e-12 1.089744e-09 9.654753e-10 ## R-HSA-69618 21/322 112/10654 1.508315e-11 2.171973e-09 1.924292e-09 ## R-HSA-68877 26/322 200/10654 2.966075e-10 3.559290e-08 3.153406e-08 ## geneID ## R-HSA-69620 CDC45/CDCA8/MCM10/CDC20/CENPE/CCNB2/NDC80/UBE2C/SKA1/CENPM/CENPN/CCNA2/CDK1/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/CHEK1/CCNB1/MCM5/MCM2/KIF2C/CDC25A/CDC6/PLK1/BUB1B/GTSE1/EXO1/ZWINT/CENPU/SPC25/CENPI/CCNE1/ORC6/ORC1/TAOK1 ## R-HSA-2500257 CDCA8/CDC20/CENPE/CCNB2/NDC80/SKA1/CENPM/CENPN/CDK1/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/CCNB1/KIF2C/PLK1/BUB1B/ZWINT/CENPU/SPC25/CENPI/TAOK1 ## R-HSA-141424 CDCA8/CDC20/CENPE/NDC80/SKA1/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/KIF2C/PLK1/BUB1B/ZWINT/CENPU/SPC25/CENPI/TAOK1 ## R-HSA-141444 CDCA8/CDC20/CENPE/NDC80/SKA1/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/KIF2C/PLK1/BUB1B/ZWINT/CENPU/SPC25/CENPI/TAOK1 ## R-HSA-69618 CDCA8/CDC20/CENPE/NDC80/UBE2C/SKA1/CENPM/CENPN/ERCC6L/MAD2L1/KIF18A/BIRC5/AURKB/KIF2C/PLK1/BUB1B/ZWINT/CENPU/SPC25/CENPI/TAOK1 ## R-HSA-68877 CDCA8/CDC20/CENPE/CCNB2/NDC80/NCAPH/SKA1/NEK2/CENPM/CENPN/CDK1/ERCC6L/MAD2L1/KIF18A/BIRC5/NCAPG/AURKB/CCNB1/KIF2C/PLK1/BUB1B/ZWINT/CENPU/SPC25/CENPI/TAOK1 ## Count ## R-HSA-69620 37 ## R-HSA-2500257 23 ## R-HSA-141424 20 ## R-HSA-141444 20 ## R-HSA-69618 21 ## R-HSA-68877 26 8.3 Reactome pathway gene set enrichment analysis y &lt;- gsePathway(geneList, nPerm=10000, pvalueCutoff=0.2, pAdjustMethod=&quot;BH&quot;, verbose=FALSE) head(y) ## ID ## R-HSA-1474244 R-HSA-1474244 ## R-HSA-216083 R-HSA-216083 ## R-HSA-3000178 R-HSA-3000178 ## R-HSA-1650814 R-HSA-1650814 ## R-HSA-3000171 R-HSA-3000171 ## R-HSA-2022090 R-HSA-2022090 ## Description ## R-HSA-1474244 Extracellular matrix organization ## R-HSA-216083 Integrin cell surface interactions ## R-HSA-3000178 ECM proteoglycans ## R-HSA-1650814 Collagen biosynthesis and modifying enzymes ## R-HSA-3000171 Non-integrin membrane-ECM interactions ## R-HSA-2022090 Assembly of collagen fibrils and other multimeric structures ## setSize enrichmentScore NES pvalue p.adjust ## R-HSA-1474244 266 -0.4576106 -1.936754 0.0001332268 0.003176563 ## R-HSA-216083 80 -0.5123103 -1.860721 0.0001546790 0.003176563 ## R-HSA-3000178 74 -0.6262504 -2.247901 0.0001555210 0.003176563 ## R-HSA-1650814 53 -0.5915513 -2.000152 0.0001596934 0.003176563 ## R-HSA-3000171 56 -0.5863352 -2.000599 0.0001598210 0.003176563 ## R-HSA-2022090 54 -0.5600621 -1.898797 0.0001598977 0.003176563 ## qvalues rank leading_edge ## R-HSA-1474244 0.002306638 1943 tags=33%, list=16%, signal=29% ## R-HSA-216083 0.002306638 1890 tags=39%, list=15%, signal=33% ## R-HSA-3000178 0.002306638 1890 tags=46%, list=15%, signal=39% ## R-HSA-1650814 0.002306638 1890 tags=47%, list=15%, signal=40% ## R-HSA-3000171 0.002306638 2538 tags=45%, list=20%, signal=36% ## R-HSA-2022090 0.002306638 1897 tags=54%, list=15%, signal=46% ## core_enrichment ## R-HSA-1474244 825/8038/11132/4017/1288/4811/3910/3371/1291/3791/831/1301/4238/7450/3685/80781/1280/1306/4314/3675/8425/977/4054/7837/7042/3912/4322/1278/1511/4060/30008/1277/164656/22795/10516/81578/1293/2247/1295/58494/8076/5118/2192/1281/83700/50509/4319/1290/1513/11096/2202/4313/2199/3693/10536/1294/11117/3339/1462/1289/1292/3908/4016/3909/4053/6678/1296/633/5654/2331/63923/7043/3913/1300/2200/1634/7177/1287/3679/4680/2006/7373/1307/1311/1308/652/4148/54829/4239 ## R-HSA-216083 1288/3371/1291/3791/7450/3685/80781/1280/3675/1278/4060/1277/1293/1295/58494/1281/83700/50509/1290/3693/1294/3339/1289/1292/1296/1300/2200/1287/3679/1307/1311 ## R-HSA-3000178 1288/3910/3371/1291/3685/1280/7042/3912/1278/4060/1277/1293/1281/50509/1290/3693/3339/1462/1289/1292/3908/3909/6678/633/2331/63923/7043/3913/1634/1287/3679/1311/4148/54829 ## R-HSA-1650814 1288/1291/1301/80781/1280/1306/1278/1277/81578/1293/1295/5118/1281/50509/1290/10536/1294/1289/1292/1296/1300/1287/7373/1307/1308 ## R-HSA-3000171 7057/3915/6385/4921/1288/3910/3371/1301/3685/1280/3912/1278/1277/2247/1281/50509/1290/3693/3339/1289/3908/3909/3913/1300/1287 ## R-HSA-2022090 4017/1288/1291/1301/80781/1280/1306/4314/977/7837/4322/1278/1277/1293/1295/5118/1281/50509/1290/1294/1289/1292/4016/3909/1296/1300/1287/7373/1308 8.4 Pathway Visualization ReactomePA implemented the viewPathway() to visualized selected reactome pathway. More general purpose of visualization methods for ORA and GSEA results are provided in the enrichplot package and are documented on Chapter 14. viewPathway(&quot;E2F mediated regulation of DNA replication&quot;, readable = TRUE, foldChange = geneList) References "],
["dose-enrichment.html", "Chapter 9 DO enrichment analysis 9.1 enrichDO function 9.2 enrichNCG function 9.3 enrichDGN and enrichDGNv functions 9.4 gseDO fuction 9.5 gseNCG fuction 9.6 gseDGN fuction", " Chapter 9 DO enrichment analysis DOSE(G. Yu et al. 2015) supports Disease Ontology (DO) Semantic and Enrichment analysis. The enrichDO function is very useful for identifying disease association of interesting genes, and function gseDO function is designed for gene set enrichment analysis of DO. In addition, DOSE also supports enrichment analysis of Network of Cancer Gene (NCG)(A. et al. 2016) and Disease Gene Network(Janet et al. 2015), please refer to the DOSE vignettes. 9.1 enrichDO function In the following example, we selected fold change above 1.5 as the differential genes and analyzing their disease association. library(DOSE) data(geneList) gene &lt;- names(geneList)[abs(geneList) &gt; 1.5] head(gene) ## [1] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; &quot;991&quot; x &lt;- enrichDO(gene = gene, ont = &quot;DO&quot;, pvalueCutoff = 0.05, pAdjustMethod = &quot;BH&quot;, universe = names(geneList), minGSSize = 5, maxGSSize = 500, qvalueCutoff = 0.05, readable = FALSE) head(x) ## ID Description GeneRatio BgRatio ## DOID:170 DOID:170 endocrine gland cancer 48/331 472/6268 ## DOID:10283 DOID:10283 prostate cancer 40/331 394/6268 ## DOID:3459 DOID:3459 breast carcinoma 37/331 357/6268 ## DOID:3856 DOID:3856 male reproductive organ cancer 40/331 404/6268 ## DOID:824 DOID:824 periodontitis 16/331 109/6268 ## DOID:3905 DOID:3905 lung carcinoma 43/331 465/6268 ## pvalue p.adjust qvalue ## DOID:170 5.662129e-06 0.004784499 0.003826407 ## DOID:10283 3.859157e-05 0.013921739 0.011133923 ## DOID:3459 4.942629e-05 0.013921739 0.011133923 ## DOID:3856 6.821467e-05 0.014410349 0.011524689 ## DOID:824 1.699304e-04 0.018859464 0.015082872 ## DOID:3905 1.749754e-04 0.018859464 0.015082872 ## geneID ## DOID:170 10874/7153/1381/6241/11065/10232/332/6286/2146/10112/891/9232/4171/993/5347/4318/3576/1515/4821/8836/3159/7980/5888/333/898/9768/4288/3551/2152/9590/185/7043/3357/2952/5327/3667/1634/1287/4582/7122/3479/4680/6424/80310/652/8839/9547/1524 ## DOID:10283 4312/6280/6279/597/3627/332/6286/2146/4321/4521/891/5347/4102/4318/701/3576/79852/10321/6352/4288/3551/2152/247/2952/3487/367/3667/4128/4582/563/3679/4117/7031/3479/6424/10451/80310/652/4036/10551 ## DOID:3459 4312/6280/6279/7153/4751/890/4085/332/6286/6790/891/9232/10855/4171/5347/4318/701/2633/3576/9636/898/8792/4288/2952/4982/4128/4582/7031/3479/771/4250/2066/3169/10647/5304/5241/10551 ## DOID:3856 4312/6280/6279/597/3627/332/6286/2146/4321/4521/891/5347/4102/4318/701/3576/79852/10321/6352/4288/3551/2152/247/2952/3487/367/3667/4128/4582/563/3679/4117/7031/3479/6424/10451/80310/652/4036/10551 ## DOID:824 4312/6279/820/7850/4321/3595/4318/4069/3576/1493/6352/8842/185/2952/5327/4982 ## DOID:3905 4312/6280/2305/9133/6279/7153/6278/6241/55165/11065/8140/10232/332/6286/3002/9212/4521/891/4171/9928/8061/4318/3576/1978/1894/7980/7083/898/6352/8842/4288/2152/2697/2952/3572/4582/7049/563/3479/1846/3117/2532/2922 ## Count ## DOID:170 48 ## DOID:10283 40 ## DOID:3459 37 ## DOID:3856 40 ## DOID:824 16 ## DOID:3905 43 The enrichDO function requires an entrezgene ID vector as input, mostly is the differential gene list of gene expression profile studies. If user needs to convert other gene ID type to entrezgene ID, we recommend using bitr function provided by clusterProfiler. The ont parameter can be ‚ÄúDO‚Äù or ‚ÄúDOLite‚Äù, DOLite(Du et al. 2009) was constructed to aggregate the redundant DO terms. The DOLite data is not updated, we recommend user use ont=\"DO\". pvalueCutoff setting the cutoff value of p value and p value adjust; pAdjustMethod setting the p value correction methods, include the Bonferroni correction (‚Äúbonferroni‚Äù), Holm (‚Äúholm‚Äù), Hochberg (‚Äúhochberg‚Äù), Hommel (‚Äúhommel‚Äù), Benjamini &amp; Hochberg (‚ÄúBH‚Äù) and Benjamini &amp; Yekutieli (‚ÄúBY‚Äù) while qvalueCutoff is used to control q-values. The universe setting the background gene universe for testing. If user do not explicitly setting this parameter, enrichDO will set the universe to all human genes that have DO annotation. The minGSSize (and maxGSSize) indicates that only those DO terms that have more than minGSSize (and less than maxGSSize) genes annotated will be tested. The readable is a logical parameter, indicates whether the entrezgene IDs will mapping to gene symbols or not. We also implement setReadable function that helps the user to convert entrezgene IDs to gene symbols. x &lt;- setReadable(x, &#39;org.Hs.eg.db&#39;) head(x) ## ID Description GeneRatio BgRatio ## DOID:170 DOID:170 endocrine gland cancer 48/331 472/6268 ## DOID:10283 DOID:10283 prostate cancer 40/331 394/6268 ## DOID:3459 DOID:3459 breast carcinoma 37/331 357/6268 ## DOID:3856 DOID:3856 male reproductive organ cancer 40/331 404/6268 ## DOID:824 DOID:824 periodontitis 16/331 109/6268 ## DOID:3905 DOID:3905 lung carcinoma 43/331 465/6268 ## pvalue p.adjust qvalue ## DOID:170 5.662129e-06 0.004784499 0.003826407 ## DOID:10283 3.859157e-05 0.013921739 0.011133923 ## DOID:3459 4.942629e-05 0.013921739 0.011133923 ## DOID:3856 6.821467e-05 0.014410349 0.011524689 ## DOID:824 1.699304e-04 0.018859464 0.015082872 ## DOID:3905 1.749754e-04 0.018859464 0.015082872 ## geneID ## DOID:170 NMU/TOP2A/CRABP1/RRM2/UBE2C/MSLN/BIRC5/S100P/EZH2/KIF20A/CCNB1/PTTG1/MCM2/CDC25A/PLK1/MMP9/CXCL8/CTSV/NKX2-2/GGH/HMGA1/TFPI2/RAD51/APLP1/CCNE1/PCLAF/MKI67/IKBKB/F3/AKAP12/AGTR1/TGFB3/HTR2B/GSTT1/PLAT/IRS1/DCN/COL4A5/MUC1/CLDN5/IGF1/CEACAM6/SFRP4/PDGFD/BMP4/CCN5/CXCL14/CX3CR1 ## DOID:10283 MMP1/S100A9/S100A8/BCL2A1/CXCL10/BIRC5/S100P/EZH2/MMP12/NUDT1/CCNB1/PLK1/MAGEA3/MMP9/BUB1B/CXCL8/EPHX3/CRISP3/CCL5/MKI67/IKBKB/F3/ALOX15B/GSTT1/IGFBP4/AR/IRS1/MAOA/MUC1/AZGP1/ITGA7/MAK/TFF1/IGF1/SFRP4/VAV3/PDGFD/BMP4/LRP2/AGR2 ## DOID:3459 MMP1/S100A9/S100A8/TOP2A/NEK2/CCNA2/MAD2L1/BIRC5/S100P/AURKA/CCNB1/PTTG1/HPSE/MCM2/PLK1/MMP9/BUB1B/GBP1/CXCL8/ISG15/CCNE1/TNFRSF11A/MKI67/GSTT1/TNFRSF11B/MAOA/MUC1/TFF1/IGF1/CA12/SCGB2A2/ERBB4/FOXA1/SCGB1D2/PIP/PGR/AGR2 ## DOID:3856 MMP1/S100A9/S100A8/BCL2A1/CXCL10/BIRC5/S100P/EZH2/MMP12/NUDT1/CCNB1/PLK1/MAGEA3/MMP9/BUB1B/CXCL8/EPHX3/CRISP3/CCL5/MKI67/IKBKB/F3/ALOX15B/GSTT1/IGFBP4/AR/IRS1/MAOA/MUC1/AZGP1/ITGA7/MAK/TFF1/IGF1/SFRP4/VAV3/PDGFD/BMP4/LRP2/AGR2 ## DOID:824 MMP1/S100A8/CAMP/IL1R2/MMP12/IL12RB2/MMP9/LYZ/CXCL8/CTLA4/CCL5/PROM1/AGTR1/GSTT1/PLAT/TNFRSF11B ## DOID:3905 MMP1/S100A9/FOXM1/CCNB2/S100A8/TOP2A/S100A7/RRM2/CEP55/UBE2C/SLC7A5/MSLN/BIRC5/S100P/GZMB/AURKB/NUDT1/CCNB1/MCM2/KIF14/FOSL1/MMP9/CXCL8/EIF4EBP1/ECT2/TFPI2/TK1/CCNE1/CCL5/PROM1/MKI67/F3/GJA1/GSTT1/IL6ST/MUC1/TGFBR3/AZGP1/IGF1/DUSP4/HLA-DQA1/ACKR1/GRP ## Count ## DOID:170 48 ## DOID:10283 40 ## DOID:3459 37 ## DOID:3856 40 ## DOID:824 16 ## DOID:3905 43 9.2 enrichNCG function Network of Cancer Gene (NCG)(A. et al. 2016) is a manually curated repository of cancer genes. NCG release 5.0 (Aug.¬†2015) collects 1,571 cancer genes from 175 published studies. DOSE supports analyzing gene list and determine whether they are enriched in genes known to be mutated in a given cancer type. gene2 &lt;- names(geneList)[abs(geneList) &lt; 3] ncg &lt;- enrichNCG(gene2) head(ncg) ## ID Description GeneRatio ## soft_tissue_sarcomas soft_tissue_sarcomas soft_tissue_sarcomas 28/1172 ## bladder bladder bladder 61/1172 ## glioma glioma glioma 68/1172 ## BgRatio pvalue p.adjust qvalue ## soft_tissue_sarcomas 28/1571 0.0002517511 0.008056037 0.006360029 ## bladder 67/1571 0.0005108168 0.008173069 0.006452423 ## glioma 76/1571 0.0008511747 0.009079196 0.007167787 ## geneID ## soft_tissue_sarcomas 1029/999/6850/4914/4342/2185/55294/2041/4851/23512/2044/4058/5290/8726/4486/5297/5728/3815/2324/7403/5925/4763/1499/7157/5159/2045/3667/2066 ## bladder 9700/2175/9603/1029/8997/688/1026/896/677/6256/55294/8085/4851/3265/1999/3845/8243/10605/8295/4854/5290/2033/4780/23224/23217/2064/23385/55252/10735/4853/387/288/30849/9794/7403/287/463/472/4297/2065/2262/8289/9611/5925/2068/4763/7157/2186/1387/3910/2261/7248/23037/23345/7832/79633/10628/22906/388/4036/3169 ## glioma 4603/4609/1029/3418/8877/1019/7027/4613/1030/1956/1106/2264/3417/6597/4914/55359/896/894/2321/3954/5335/5781/8439/673/9444/4851/8087/2050/8493/3845/3482/667/56999/5290/2033/4233/577/5894/5156/80036/9407/3020/1021/5598/5728/8621/1828/63035/23592/8880/2260/54880/4916/2263/1639/90/546/8289/4763/7157/23152/5295/4602/595/2261/6938/4915/26137 ## Count ## soft_tissue_sarcomas 28 ## bladder 61 ## glioma 68 9.3 enrichDGN and enrichDGNv functions DisGeNET(Janet et al. 2015) is an integrative and comprehensive resources of gene-disease associations from several public data sources and the literature. It contains gene-disease associations and snp-gene-disease associations. The enrichment analysis of disease-gene associations is supported by the enrichDGN function and analysis of snp-gene-disease associations is supported by the enrichDGNv function. dgn &lt;- enrichDGN(gene) head(dgn) ## ID Description GeneRatio ## umls:C1134719 umls:C1134719 Invasive Ductal Breast Carcinoma 28/476 ## umls:C0032460 umls:C0032460 Polycystic Ovary Syndrome 38/476 ## umls:C0206698 umls:C0206698 Cholangiocarcinoma 36/476 ## umls:C0007138 umls:C0007138 Carcinoma, Transitional Cell 35/476 ## umls:C0031099 umls:C0031099 Periodontitis 28/476 ## umls:C0005695 umls:C0005695 Bladder Neoplasm 36/476 ## BgRatio pvalue p.adjust qvalue ## umls:C1134719 231/17381 4.312190e-11 1.225524e-07 9.164539e-08 ## umls:C0032460 434/17381 2.819624e-10 3.521620e-07 2.633487e-07 ## umls:C0206698 399/17381 3.717403e-10 3.521620e-07 2.633487e-07 ## umls:C0007138 389/17381 7.093837e-10 5.040171e-07 3.769068e-07 ## umls:C0031099 270/17381 1.634417e-09 9.290027e-07 6.947133e-07 ## umls:C0005695 442/17381 5.871618e-09 2.781190e-06 2.079789e-06 ## geneID ## umls:C1134719 9133/7153/6241/55165/11065/51203/22974/4751/5080/332/2568/3902/6790/891/24137/9232/10855/79801/4318/55635/5888/1493/9768/3070/4288/367/4582/5241 ## umls:C0032460 4312/6280/6279/7153/259266/6241/55165/55872/4085/6286/7272/366/891/4171/7941/1164/3161/4603/990/29127/4318/53335/3294/3070/2952/5327/367/3667/4582/563/27324/3479/114899/9370/2167/652/5346/5241 ## umls:C0206698 4312/2305/55872/4751/8140/10635/10232/5918/332/6286/2146/4521/891/10855/2921/7941/1164/4318/3576/1978/79852/8842/4485/214/65982/6863/1036/6935/4128/3572/4582/7031/7166/4680/80310/9 ## umls:C0007138 4312/991/6280/6241/55165/10460/6373/8140/890/10232/4085/332/6286/2146/4171/1033/6364/5347/4318/3576/8836/9700/898/4288/2952/367/8382/2947/3479/9338/23158/2167/2066/2625/9 ## umls:C0031099 4312/6279/3669/820/7850/332/4321/6364/3595/4318/3576/3898/8792/1493/4485/10472/185/6863/2205/2952/5327/4982/23261/2200/3572/2006/1308/2625 ## umls:C0005695 4312/10874/6280/3868/6279/597/7153/6241/9582/10460/4085/5080/332/2146/6790/10855/4171/5347/4318/3576/8836/9636/9700/898/4288/214/2952/367/2947/4582/3479/6424/9338/2066/1580/9 ## Count ## umls:C1134719 28 ## umls:C0032460 38 ## umls:C0206698 36 ## umls:C0007138 35 ## umls:C0031099 28 ## umls:C0005695 36 snp &lt;- c(&quot;rs1401296&quot;, &quot;rs9315050&quot;, &quot;rs5498&quot;, &quot;rs1524668&quot;, &quot;rs147377392&quot;, &quot;rs841&quot;, &quot;rs909253&quot;, &quot;rs7193343&quot;, &quot;rs3918232&quot;, &quot;rs3760396&quot;, &quot;rs2231137&quot;, &quot;rs10947803&quot;, &quot;rs17222919&quot;, &quot;rs386602276&quot;, &quot;rs11053646&quot;, &quot;rs1805192&quot;, &quot;rs139564723&quot;, &quot;rs2230806&quot;, &quot;rs20417&quot;, &quot;rs966221&quot;) dgnv &lt;- enrichDGNv(snp) head(dgnv) ## ID Description GeneRatio ## umls:C3272363 umls:C3272363 Ischemic Cerebrovascular Accident 20/20 ## umls:C0948008 umls:C0948008 Ischemic stroke 20/20 ## umls:C0038454 umls:C0038454 Cerebrovascular accident 7/20 ## umls:C0027051 umls:C0027051 Myocardial Infarction 6/20 ## umls:C0010054 umls:C0010054 Coronary Arteriosclerosis 6/20 ## umls:C0010068 umls:C0010068 Coronary heart disease 6/20 ## BgRatio pvalue p.adjust qvalue ## umls:C3272363 141/46589 1.014503e-51 1.379725e-49 1.922217e-50 ## umls:C0948008 148/46589 2.867870e-51 1.950151e-49 2.716929e-50 ## umls:C0038454 243/46589 7.045680e-12 3.194042e-10 4.449903e-11 ## umls:C0027051 163/46589 6.222154e-11 1.889883e-09 2.632964e-10 ## umls:C0010054 166/46589 6.948100e-11 1.889883e-09 2.632964e-10 ## umls:C0010068 314/46589 3.198889e-09 7.250815e-08 1.010175e-08 ## geneID ## umls:C3272363 rs1401296/rs9315050/rs5498/rs1524668/rs147377392/rs841/rs909253/rs7193343/rs3918232/rs3760396/rs2231137/rs10947803/rs17222919/rs386602276/rs11053646/rs1805192/rs139564723/rs2230806/rs20417/rs966221 ## umls:C0948008 rs1401296/rs9315050/rs5498/rs1524668/rs147377392/rs841/rs909253/rs7193343/rs3918232/rs3760396/rs2231137/rs10947803/rs17222919/rs386602276/rs11053646/rs1805192/rs139564723/rs2230806/rs20417/rs966221 ## umls:C0038454 rs1524668/rs147377392/rs2231137/rs10947803/rs386602276/rs2230806/rs20417 ## umls:C0027051 rs5498/rs147377392/rs909253/rs11053646/rs1805192/rs20417 ## umls:C0010054 rs5498/rs147377392/rs11053646/rs1805192/rs2230806/rs20417 ## umls:C0010068 rs5498/rs147377392/rs11053646/rs1805192/rs2230806/rs20417 ## Count ## umls:C3272363 20 ## umls:C0948008 20 ## umls:C0038454 7 ## umls:C0027051 6 ## umls:C0010054 6 ## umls:C0010068 6 9.4 gseDO fuction In the following example, in order to speedup the compilation of this document, only gene sets with size above 120 were tested and only 100 permutations were performed. library(DOSE) data(geneList) y &lt;- gseDO(geneList, nPerm = 100, minGSSize = 120, pvalueCutoff = 0.2, pAdjustMethod = &quot;BH&quot;, verbose = FALSE) head(y, 3) ## ID Description setSize ## DOID:1492 DOID:1492 eye and adnexa disease 459 ## DOID:5614 DOID:5614 eye disease 450 ## DOID:0060037 DOID:0060037 developmental disorder of mental health 315 ## enrichmentScore NES pvalue p.adjust qvalues rank ## DOID:1492 -0.3105160 -1.361216 0.01234568 0.07869674 0.03271336 1793 ## DOID:5614 -0.3125247 -1.375913 0.01234568 0.07869674 0.03271336 1768 ## DOID:0060037 -0.3407349 -1.449103 0.01250000 0.07869674 0.03271336 2313 ## leading_edge ## DOID:1492 tags=22%, list=14%, signal=19% ## DOID:5614 tags=22%, list=14%, signal=19% ## DOID:0060037 tags=24%, list=19%, signal=20% ## core_enrichment ## DOID:1492 8106/3371/3082/5914/2878/4153/3791/23247/1543/80184/6750/1958/2098/7450/596/9187/2034/482/948/1490/1280/3931/5737/4314/4881/2261/3426/187/629/6403/7042/6785/7507/2934/5176/4060/1277/7078/5950/2057/727/10516/4311/2247/1295/358/10203/2192/582/10218/57125/3485/585/1675/6310/2202/4313/2944/4254/3075/1501/2099/3480/4653/1195/6387/3305/1471/857/4016/1909/4053/6678/1296/7033/4915/55812/1191/5654/10631/2152/2697/7043/2952/6935/2200/3572/7177/7031/3479/2006/10451/9370/771/3117/125/652/4693/5346/1524 ## DOID:5614 3371/3082/5914/2878/4153/3791/23247/1543/80184/6750/1958/2098/7450/596/9187/2034/482/948/1490/1280/3931/5737/4314/4881/2261/3426/187/629/6403/7042/6785/7507/2934/5176/4060/1277/7078/5950/2057/727/10516/4311/2247/1295/358/10203/2192/582/10218/57125/3485/585/1675/6310/2202/4313/2944/4254/3075/1501/2099/3480/4653/6387/3305/1471/857/4016/1909/4053/6678/1296/7033/4915/55812/1191/5654/10631/2152/2697/7043/2952/6935/2200/3572/7177/7031/3479/2006/10451/9370/771/3117/125/652/4693/5346/1524 ## DOID:0060037 10585/154/1760/9732/7337/5175/6532/4763/54806/9759/6326/1499/7157/221037/627/2908/3399/2571/3082/23503/3791/51265/27347/55650/596/3067/51185/7552/22829/23426/324/5021/4885/7248/8910/8604/3397/4208/3400/26470/553/3953/6812/64221/80208/5172/9037/3952/477/93664/3625/2944/6925/6594/7102/3908/2550/4915/4922/26960/1746/2697/6863/3913/2891/367/4128/150/7166/6505/5348/18/4129/9370/57502/4137/79083 9.5 gseNCG fuction ncg &lt;- gseNCG(geneList, nPerm = 100, minGSSize = 120, pvalueCutoff = 0.2, pAdjustMethod = &quot;BH&quot;, verbose = FALSE) ncg &lt;- setReadable(ncg, &#39;org.Hs.eg.db&#39;) head(ncg, 3) ## [1] ID Description setSize enrichmentScore ## [5] NES pvalue p.adjust qvalues ## &lt;0 rows&gt; (or 0-length row.names) 9.6 gseDGN fuction dgn &lt;- gseDGN(geneList, nPerm = 100, minGSSize = 120, pvalueCutoff = 0.2, pAdjustMethod = &quot;BH&quot;, verbose = FALSE) dgn &lt;- setReadable(dgn, &#39;org.Hs.eg.db&#39;) head(dgn, 3) ## ID Description setSize enrichmentScore ## umls:C0011581 umls:C0011581 Depressive disorder 464 -0.2963136 ## umls:C0338656 umls:C0338656 Impaired cognition 342 -0.3266625 ## umls:C0029456 umls:C0029456 Osteoporosis 375 -0.3439046 ## NES pvalue p.adjust qvalues rank ## umls:C0011581 -1.300529 0.01282051 0.1203209 0.07796229 2587 ## umls:C0338656 -1.407470 0.01298701 0.1203209 0.07796229 1997 ## umls:C0029456 -1.482280 0.01315789 0.1203209 0.07796229 1766 ## leading_edge ## umls:C0011581 tags=29%, list=21%, signal=24% ## umls:C0338656 tags=23%, list=16%, signal=20% ## umls:C0029456 tags=23%, list=14%, signal=20% ## core_enrichment ## umls:C0011581 GRM3/ATM/TRH/CYP2E1/IFNAR1/TTR/CALD1/BCL2L1/CRH/SUCLA2/CNR1/MTR/ARNTL/PER1/GDE1/SLC29A3/FOSB/TH/HTR7/SMPD1/ETS2/HDAC5/RGN/GRIA1/PTGS1/PDE4A/SNCA/ADAMTS2/EHD3/NR5A1/SORCS3/CRY1/ADRB2/FZD1/MYOM2/ADCY1/POU6F1/MAPK3/BICC1/SLC6A4/AHI1/TP53/RNF103/SLC12A2/BDNF/NR3C1/SRSF5/PCLO/GABRA6/WWC1/IL5/GLUL/ELK3/GAD1/RARA/GRM5/KDR/ASAH1/IMPACT/CHRM2/WFS1/TSPAN31/HP/PVALB/HTR1A/BCL2/GPM6A/CYP2A6/DUSP1/NLGN4Y/F2R/CD36/NGFR/NPY2R/DBH/BECN1/CCND1/OXTR/SGCE/SELP/NGF/LPAR1/NRP1/AVPR1B/IFT88/ARSD/FAAH/NEFL/FGF2/CD1C/ABCB1/SRPX/RAPGEF3/CRHBP/HSPA2/LEP/FTO/PER2/ALPK1/GSTM1/DIXDC1/XBP1/ESR1/IGF1R/NTF3/CACNA1C/NR3C2/SLC18A2/NTRK2/SPDEF/RAPGEF4/ALB/NPY1R/F3/AGTR1/TAC1/AR/UCN/FBN1/MAOA/CARTPT/TAT/ADRA2A/MUC1/TGFBR3/TPH1/IGF1/ABAT/MAOB/ADIPOQ/TBC1D9/ADH1B/CRY2/GATA3/TFAP2B ## umls:C0338656 BDNF/NR3C1/CAPN3/SLC2A10/CREBBP/ZNF224/ITM2B/ELK3/CLN5/GAD1/BACE1/HGF/SERPINA3/MBL2/SST/EGR1/INSR/UTRN/ARL4D/PVALB/EEF1A2/DYM/CD36/RAB40AL/RBMS3/TREM2/PER3/OXTR/TSC1/CDR1/IGFALS/TPPP/SELP/NGF/BCHE/KCNS3/APBB2/TRPM4/RUNX1T1/MME/ABCB1/PPARG/MVP/NME8/SPG11/LPL/SLC26A4/FHL5/KL/LEP/FTO/NAIP/SORL1/ESR1/ABCC8/CST3/LAMA2/HHAT/LRP1/CLU/ALB/SPON1/NTS/HTRA1/GSTT1/GRIA2/MAGI2/IRS1/TAT/COL4A5/AASS/IGF1/ITPR1/BMP4/LRP2/MAPT/ERBB4/GRP ## umls:C0029456 RXRG/HGF/PTH1R/CYP1A1/JAG1/ROR2/FLT3/CUL9/EEF1A2/THSD4/BCL2/ITGAV/WIF1/GREM2/COL15A1/HPGDS/VGLL3/SLIT3/NRIP1/TMEM135/MGP/PLCL1/OSBPL1A/PIBF1/SELP/SPRY1/MMP13/ID4/SPP2/COL1A2/AOX1/ARHGEF3/GSN/TSC22D3/ATP1B1/NR5A2/ANKH/COL1A1/LEPR/THSD7A/GC/FGF2/PPARG/NOX4/ZNF266/GHRH/BHLHE40/SLC19A2/THBD/FLNB/KL/LEP/HSD17B4/CTSK/FTO/MMP2/ESR1/IGF1R/PTN/IRAK3/HSPA1L/CST3/GHR/SPARC/KDM4B/LRP1/INPP4B/BMPR1B/PTHLH/DPT/FRZB/GSTT1/AR/TNFRSF11B/IRS1/WLS/GSTM3/TGFBR3/TPH1/IGF1/SFRP4/CORIN/BMP4/CHAD/FOXA1/PGR References "],
["meshes-enrichment.html", "Chapter 10 MeSH enrichment analysis", " Chapter 10 MeSH enrichment analysis meshes supports enrichment analysis (over-representation analysis and gene set enrichment analysis) of gene list or whole expression profile using MeSH annotation. Data source from gendoo, gene2pubmed and RBBH are all supported. User can selecte interesting category to test. All 16 categories are supported. The analysis supports &gt;70 species listed in MeSHDb BiocView. For algorithm details, please refer to the vignettes of DOSE(G. Yu et al. 2015) package. library(meshes) data(geneList, package=&quot;DOSE&quot;) de &lt;- names(geneList)[1:100] x &lt;- enrichMeSH(de, MeSHDb = &quot;MeSH.Hsa.eg.db&quot;, database=&#39;gendoo&#39;, category = &#39;C&#39;) head(x) ## ID Description GeneRatio BgRatio pvalue ## D043171 D043171 Chromosomal Instability 16/96 198/16528 2.794765e-14 ## D000782 D000782 Aneuploidy 17/96 320/16528 3.866830e-12 ## D042822 D042822 Genomic Instability 16/96 312/16528 3.007419e-11 ## D012595 D012595 Scleroderma, Systemic 11/96 279/16528 6.449334e-07 ## D009303 D009303 Nasopharyngeal Neoplasms 11/96 314/16528 2.049315e-06 ## D019698 D019698 Hepatitis C, Chronic 11/96 317/16528 2.246856e-06 ## p.adjust qvalue ## D043171 2.459394e-11 1.815127e-11 ## D000782 1.701405e-09 1.255702e-09 ## D042822 8.821761e-09 6.510798e-09 ## D012595 1.418854e-04 1.047168e-04 ## D009303 3.295389e-04 2.432123e-04 ## D019698 3.295389e-04 2.432123e-04 ## geneID ## D043171 4312/991/2305/1062/4605/10403/7153/55355/4751/4085/81620/332/7272/9212/1111/6790 ## D000782 4312/55143/991/1062/7153/4751/79019/55839/890/983/4085/332/7272/9212/8208/1111/6790 ## D042822 55143/991/1062/4605/7153/1381/9787/4751/10635/890/4085/81620/332/9212/1111/6790 ## D012595 4312/6280/1062/4605/7153/3627/4283/6362/7850/3002/4321 ## D009303 4312/7153/3627/6241/983/4085/5918/332/3002/4321/6790 ## D019698 4312/3627/10563/6373/4283/983/6362/7850/332/3002/3620 ## Count ## D043171 16 ## D000782 17 ## D042822 16 ## D012595 11 ## D009303 11 ## D019698 11 In the over-representation analysis, we use data source from gendoo and C (Diseases) category. In the following example, we use data source from gene2pubmed and test category G (Phenomena and Processes) using GSEA. y &lt;- gseMeSH(geneList, MeSHDb = &quot;MeSH.Hsa.eg.db&quot;, database = &#39;gene2pubmed&#39;, category = &quot;G&quot;) head(y) ## ID Description setSize enrichmentScore NES ## D009043 D009043 Motor Activity 462 -0.3223426 -1.429892 ## D009119 D009119 Muscle Contraction 438 -0.3244845 -1.435352 ## D012038 D012038 Regeneration 426 -0.3212385 -1.416924 ## D006339 D006339 Heart Rate 336 -0.3640991 -1.575108 ## D066253 D066253 Vascular Remodeling 272 -0.5306958 -2.247212 ## D001846 D001846 Bone Development 322 -0.3722690 -1.601491 ## pvalue p.adjust qvalues rank leading_edge ## D009043 0.001204819 0.03930545 0.02899514 2176 tags=23%, list=17%, signal=20% ## D009119 0.001206273 0.03930545 0.02899514 2517 tags=27%, list=20%, signal=22% ## D012038 0.001213592 0.03930545 0.02899514 2132 tags=27%, list=17%, signal=23% ## D006339 0.001257862 0.03930545 0.02899514 2405 tags=29%, list=19%, signal=24% ## D066253 0.001262626 0.03930545 0.02899514 2060 tags=43%, list=16%, signal=37% ## D001846 0.001267427 0.03930545 0.02899514 2100 tags=27%, list=17%, signal=23% ## core_enrichment ## D009043 6532/10550/9759/23405/1499/6453/8945/7157/25970/627/408/2908/22881/27445/11132/2752/9445/6548/2571/23621/3082/1291/2915/1543/7466/3240/3350/947/55304/181/3632/2169/27306/1621/80169/9627/196/8678/8863/23284/81627/4692/5799/11076/2259/3087/1278/283/1277/3953/4747/2247/6414/210/4744/5468/8835/89795/4023/8522/4319/3485/3952/79068/8864/4313/2944/2273/2099/3480/8528/4908/56892/3339/5138/57161/4741/4306/6571/79750/4915/5744/2487/58503/347/6863/2952/5327/367/4982/4128/4059/3572/150/7060/9358/7166/3479/9254/5348/4129/9370/3708/1311/5105/4137/1408/5241 ## D009119 5742/10174/2150/5562/3611/22859/4604/7070/4985/7139/3784/154/1760/3315/9732/72/5595/3092/6416/9759/270/6558/627/953/408/2908/7138/5563/6794/5564/3567/2104/845/3371/6548/831/182/3554/126393/7402/1129/7201/3350/5590/5592/7168/79923/2149/4628/23426/8082/5021/2318/23284/844/79026/4208/3790/2308/1907/253959/54795/4311/2247/10580/1848/2281/10398/5166/50507/1012/6876/10203/83700/11167/2317/3952/3778/1009/5733/10468/3693/6253/9499/7481/5159/3991/857/1289/1909/6678/7041/32/8639/5350/3551/1264/2697/185/55107/7043/3357/2205/253190/5327/25802/1634/3572/8490/3679/3479/5348/9370/9122/4629/652/7021/5241 ## D012038 2869/5087/1499/7157/79960/627/2252/4088/825/9149/8038/4017/7010/2752/3248/3082/22921/3791/4005/182/7402/7474/596/947/9976/9315/8840/1490/54209/1280/4804/4314/324/6019/8425/595/10979/6843/4929/79026/2246/5029/4803/7042/4322/8829/7048/10216/79679/5176/55384/7078/5549/7216/727/10516/2247/6591/56944/210/5468/23345/6469/216/8076/26509/90865/11167/7075/7058/4313/3861/91851/2199/113146/6444/9201/1294/4254/4856/6720/3480/5764/6387/6833/5159/11117/857/1289/3908/4016/6678/7033/23030/7704/174/1191/2737/5744/11098/10631/9429/214/7043/2200/1634/4582/7031/3479/7373/2066/3169/2625 ## D006339 83478/4985/7139/8929/3784/10681/3375/154/1760/9781/5139/118/2702/6532/6416/2869/270/7157/627/2908/7138/5563/3643/1129/7779/947/1901/2034/4179/4804/64388/1621/4881/8863/5021/844/4212/11030/5797/6403/4803/84059/79789/5176/3953/5243/5468/1012/2868/5793/4023/7056/3952/5577/126/2946/3778/477/5733/4313/2944/9201/3075/9499/2273/2099/1471/857/775/5138/4306/4487/213/5350/5744/23245/2152/2697/2791/185/6863/2952/5327/80206/2200/9607/3572/150/8490/3479/2006/55259/9370/125/652/55351 ## D066253 7157/83660/5269/627/953/4088/6794/6649/7010/6778/4811/3248/57124/94/3910/3371/2662/1291/1958/3490/7450/80781/948/1280/1306/8425/10085/4054/4256/3912/2817/9353/2308/1278/8829/1511/2934/4060/1277/7078/5549/22795/10516/1293/1295/6591/5468/50507/358/1012/6876/8076/5118/2192/1281/4319/1290/3952/1513/7075/7058/2202/4313/2199/2099/5159/11117/857/3339/1462/1289/1292/3908/4016/1909/3909/4053/6678/633/1191/165/5654/10631/1805/2331/347/2152/1264/247/2697/55107/7043/1359/3913/367/4982/8404/2200/1634/4059/7177/8490/563/2053/1489/3479/7373/1307/9370/79148/1311/2167/8483/54829/4239/5241/4969 ## D001846 1499/8945/7157/57798/79048/627/6500/8038/4057/860/2752/4882/3371/2915/5745/63971/54455/3791/819/57045/596/2034/54808/80781/1280/64388/2261/4054/11059/3483/9900/26234/4734/9452/4208/4322/253461/1278/7048/51280/10903/30008/7869/1277/3953/10516/10411/8835/79776/11167/2317/3485/3952/5274/54681/4488/10486/1009/2202/91851/2099/5764/23327/3339/8817/83716/6678/4915/633/658/54361/5744/165/5654/10631/3487/367/4982/3667/79971/1634/3479/114899/9370/652/8614/4969 User can use visualization methods implemented in enrichplot (i.e.barplot, dotplot, cnetplot, emapplot and gseaplot) to visualize these enrichment results. With these visualization methods, it‚Äôs much easier to interpret enriched results. dotplot(x) gseaplot(y, y[1,1], title=y[1,2]) References "],
["universal-api.html", "Chapter 11 Universal enrichment analysis 11.1 Input data 11.2 WikiPathways analysis 11.3 Cell Marker 11.4 MSigDb analysis 11.5 MSigDb", " Chapter 11 Universal enrichment analysis clusterProfiler supports both hypergeometric test and gene set enrichment analyses of many ontology/pathway, but it‚Äôs still not enough for users may want to analyze their data with unsupported organisms, slim version of GO, novel functional annotation (e.g.¬†GO via BlastGO or KEGG via KAAS), unsupported ontologies/pathways or customized annotations. clusterProfiler provides enricher function for hypergeometric test and GSEA function for gene set enrichment analysis that are designed to accept user defined annotation. They accept two additional parameters TERM2GENE and TERM2NAME. As indicated in the parameter names, TERM2GENE is a data.frame with first column of term ID and second column of corresponding mapped gene and TERM2NAME is a data.frame with first column of term ID and second column of corresponding term name. TERM2NAME is optional. 11.1 Input data For over representation analysis, all we need is a gene vector, that is a vector of gene IDs. These gene IDs can be obtained by differential expression analysis (e.g. with DESeq2 package). For gene set enrichment analysis, we need a ranked list of genes. DOSE provides an example dataset geneList which was derived from R package breastCancerMAINZ that contained 200 samples, including 29 samples in grade I, 136 samples in grade II and 35 samples in grade III. We computed the ratios of geometric means of grade III samples versus geometric means of grade I samples. Logarithm of these ratios (base 2) were stored in geneList dataset. The geneList contains three features: numeric vector: fold change or other type of numerical variable named vector: every number was named by the corresponding gene ID sorted vector: number should be sorted in decreasing order Suppose you are importing your own data from a csv file and the file contains two columns, one for gene ID (no duplicated allowed) and another one for fold change, you can prepare your own geneList via the following command: d &lt;- read.csv(your_csv_file) ## assume that 1st column is ID ## 2nd column is fold change ## feature 1: numeric vector geneList &lt;- d[,2] ## feature 2: named vector names(geneList) &lt;- as.character(d[,1]) ## feature 3: decreasing order geneList &lt;- sort(geneList, decreasing = TRUE) We can load the sample data into R via: data(geneList, package=&quot;DOSE&quot;) head(geneList) ## 4312 8318 10874 55143 55388 991 ## 4.572613 4.514594 4.418218 4.144075 3.876258 3.677857 Suppose we define fold change greater than 2 as DEGs: gene &lt;- names(geneList)[abs(geneList) &gt; 2] head(gene) ## [1] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; &quot;991&quot; 11.2 WikiPathways analysis WikiPathways is a continuously updated pathway database curated by a community of researchers and pathway enthusiasts. WikiPathways produces monthly releases of gmt files for supported organisms at data.wikipathways.org. Download the appropriate gmt file and then generate TERM2GENE and TERM2NAME to use enricher and GSEA functions. library(magrittr) library(clusterProfiler) data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] wpgmtfile &lt;- system.file(&quot;extdata/wikipathways-20180810-gmt-Homo_sapiens.gmt&quot;, package=&quot;clusterProfiler&quot;) wp2gene &lt;- read.gmt(wpgmtfile) wp2gene &lt;- wp2gene %&gt;% tidyr::separate(term, c(&quot;name&quot;,&quot;version&quot;,&quot;wpid&quot;,&quot;org&quot;), &quot;%&quot;) wpid2gene &lt;- wp2gene %&gt;% dplyr::select(wpid, gene) #TERM2GENE wpid2name &lt;- wp2gene %&gt;% dplyr::select(wpid, name) #TERM2NAME ewp &lt;- enricher(gene, TERM2GENE = wpid2gene, TERM2NAME = wpid2name) head(ewp) ## ID ## WP2446 WP2446 ## WP2361 WP2361 ## WP179 WP179 ## WP3942 WP3942 ## WP4240 WP4240 ## WP2328 WP2328 ## Description ## WP2446 Retinoblastoma (RB) in Cancer ## WP2361 Gastric Cancer Network 1 ## WP179 Cell Cycle ## WP3942 PPAR signaling pathway ## WP4240 Regulation of sister chromatid separation at the metaphase-anaphase transition ## WP2328 Allograft Rejection ## GeneRatio BgRatio pvalue p.adjust qvalue ## WP2446 11/95 88/6249 6.801697e-08 1.054263e-05 9.450779e-06 ## WP2361 6/95 29/6249 3.772735e-06 2.923870e-04 2.621058e-04 ## WP179 10/95 122/6249 1.384549e-05 7.153503e-04 6.412648e-04 ## WP3942 7/95 67/6249 6.210513e-05 2.406574e-03 2.157336e-03 ## WP4240 4/95 16/6249 7.931988e-05 2.458916e-03 2.204258e-03 ## WP2328 7/95 90/6249 4.016758e-04 1.037663e-02 9.301967e-03 ## geneID Count ## WP2446 8318/9133/7153/6241/890/983/81620/7272/1111/891/24137 11 ## WP2361 4605/7153/11065/22974/6286/6790 6 ## WP179 8318/991/9133/890/983/7272/1111/891/4174/9232 10 ## WP3942 4312/9415/9370/5105/2167/3158/5346 7 ## WP4240 991/1062/4085/9232 4 ## WP2328 10563/6373/4283/3002/10578/3117/730 7 ewp2 &lt;- GSEA(geneList, TERM2GENE = wpid2gene, TERM2NAME = wpid2name, verbose=FALSE) head(ewp2) ## ID Description setSize ## WP179 WP179 Cell Cycle 111 ## WP2446 WP2446 Retinoblastoma (RB) in Cancer 84 ## WP466 WP466 DNA Replication 42 ## WP45 WP45 G1 to S cell cycle control 62 ## WP2361 WP2361 Gastric Cancer Network 1 23 ## WP4016 WP4016 DNA IR-damage and cellular response via ATR 75 ## enrichmentScore NES pvalue p.adjust qvalues rank ## WP179 0.6632572 2.721160 1.000000e-10 1.206667e-08 1.003509e-08 1234 ## WP2446 0.7309693 2.868103 1.000000e-10 1.206667e-08 1.003509e-08 1333 ## WP466 0.7919531 2.712887 1.000000e-10 1.206667e-08 1.003509e-08 1002 ## WP45 0.6649511 2.454380 1.409652e-09 1.275735e-07 1.060949e-07 1111 ## WP2361 0.8368760 2.529722 3.497802e-09 2.532408e-07 2.106045e-07 854 ## WP4016 0.5816199 2.238304 6.605969e-08 3.985601e-06 3.314574e-06 1627 ## leading_edge ## WP179 tags=40%, list=10%, signal=36% ## WP2446 tags=51%, list=11%, signal=46% ## WP466 tags=55%, list=8%, signal=51% ## WP45 tags=42%, list=9%, signal=38% ## WP2361 tags=52%, list=7%, signal=49% ## WP4016 tags=32%, list=13%, signal=28% ## core_enrichment ## WP179 8318/991/9133/890/983/7272/1111/891/4174/9232/4171/993/990/5347/9700/898/23594/4998/9134/4175/4173/10926/6502/994/699/4609/5111/1869/1029/8317/4176/2810/3066/1871/1031/9088/995/1019/4172/5885/11200/7027/1875/7534 ## WP2446 8318/9133/7153/6241/890/983/81620/7272/1111/891/24137/993/898/4998/10733/9134/4175/4173/6502/5984/994/7298/3015/4609/5111/1869/1719/3925/8317/5427/4176/3148/5557/1871/2956/1019/4172/1633/7027/2189/5983/5603/10592 ## WP466 8318/55388/81620/4174/4171/990/23594/4998/4175/4173/10926/5984/5111/51053/8317/5427/23649/4176/5982/5557/5558/4172/5424 ## WP45 8318/983/891/4174/4171/993/898/23594/4998/9134/4175/4173/4609/5111/1869/1029/5427/23649/4176/5557/1871/1031/1019/5558/4172/7027 ## WP2361 4605/7153/11065/22974/6286/6790/1894/56992/4173/1063/9585/8607 ## WP4016 8318/2305/983/1111/4171/5347/55215/9156/5888/2175/2237/5111/1869/55159/4436/995/7398/83990/80010/7979/4683/63967/142/3014 You may want to convert the gene IDs to gene symbols, which can be done by setReadable function. library(org.Hs.eg.db) ewp &lt;- setReadable(ewp, org.Hs.eg.db, keyType = &quot;ENTREZID&quot;) ewp2 &lt;- setReadable(ewp2, org.Hs.eg.db, keyType = &quot;ENTREZID&quot;) head(ewp) ## ID ## WP2446 WP2446 ## WP2361 WP2361 ## WP179 WP179 ## WP3942 WP3942 ## WP4240 WP4240 ## WP2328 WP2328 ## Description ## WP2446 Retinoblastoma (RB) in Cancer ## WP2361 Gastric Cancer Network 1 ## WP179 Cell Cycle ## WP3942 PPAR signaling pathway ## WP4240 Regulation of sister chromatid separation at the metaphase-anaphase transition ## WP2328 Allograft Rejection ## GeneRatio BgRatio pvalue p.adjust qvalue ## WP2446 11/95 88/6249 6.801697e-08 1.054263e-05 9.450779e-06 ## WP2361 6/95 29/6249 3.772735e-06 2.923870e-04 2.621058e-04 ## WP179 10/95 122/6249 1.384549e-05 7.153503e-04 6.412648e-04 ## WP3942 7/95 67/6249 6.210513e-05 2.406574e-03 2.157336e-03 ## WP4240 4/95 16/6249 7.931988e-05 2.458916e-03 2.204258e-03 ## WP2328 7/95 90/6249 4.016758e-04 1.037663e-02 9.301967e-03 ## geneID Count ## WP2446 CDC45/CCNB2/TOP2A/RRM2/CCNA2/CDK1/CDT1/TTK/CHEK1/CCNB1/KIF4A 11 ## WP2361 MYBL2/TOP2A/UBE2C/TPX2/S100P/AURKA 6 ## WP179 CDC45/CDC20/CCNB2/CCNA2/CDK1/TTK/CHEK1/CCNB1/MCM5/PTTG1 10 ## WP3942 MMP1/FADS2/ADIPOQ/PCK1/FABP4/HMGCS2/PLIN1 7 ## WP4240 CDC20/CENPE/MAD2L1/PTTG1 4 ## WP2328 CXCL13/CXCL11/CXCL9/GZMB/GNLY/HLA-DQA1/C7 7 head(ewp2) ## ID Description setSize ## WP179 WP179 Cell Cycle 111 ## WP2446 WP2446 Retinoblastoma (RB) in Cancer 84 ## WP466 WP466 DNA Replication 42 ## WP45 WP45 G1 to S cell cycle control 62 ## WP2361 WP2361 Gastric Cancer Network 1 23 ## WP4016 WP4016 DNA IR-damage and cellular response via ATR 75 ## enrichmentScore NES pvalue p.adjust qvalues rank ## WP179 0.6632572 2.721160 1.000000e-10 1.206667e-08 1.003509e-08 1234 ## WP2446 0.7309693 2.868103 1.000000e-10 1.206667e-08 1.003509e-08 1333 ## WP466 0.7919531 2.712887 1.000000e-10 1.206667e-08 1.003509e-08 1002 ## WP45 0.6649511 2.454380 1.409652e-09 1.275735e-07 1.060949e-07 1111 ## WP2361 0.8368760 2.529722 3.497802e-09 2.532408e-07 2.106045e-07 854 ## WP4016 0.5816199 2.238304 6.605969e-08 3.985601e-06 3.314574e-06 1627 ## leading_edge ## WP179 tags=40%, list=10%, signal=36% ## WP2446 tags=51%, list=11%, signal=46% ## WP466 tags=55%, list=8%, signal=51% ## WP45 tags=42%, list=9%, signal=38% ## WP2361 tags=52%, list=7%, signal=49% ## WP4016 tags=32%, list=13%, signal=28% ## core_enrichment ## WP179 CDC45/CDC20/CCNB2/CCNA2/CDK1/TTK/CHEK1/CCNB1/MCM5/PTTG1/MCM2/CDC25A/CDC6/PLK1/ESPL1/CCNE1/ORC6/ORC1/CCNE2/MCM6/MCM4/DBF4/SKP2/CDC25B/BUB1/MYC/PCNA/E2F1/CDKN2A/CDC7/MCM7/SFN/HDAC2/E2F3/CDKN2C/PKMYT1/CDC25C/CDK4/MCM3/RAD21/CHEK2/TFDP1/E2F5/YWHAZ ## WP2446 CDC45/CCNB2/TOP2A/RRM2/CCNA2/CDK1/CDT1/TTK/CHEK1/CCNB1/KIF4A/CDC25A/CCNE1/ORC1/PLK4/CCNE2/MCM6/MCM4/SKP2/RFC4/CDC25B/TYMS/H2AZ1/MYC/PCNA/E2F1/DHFR/STMN1/CDC7/POLE2/MCM7/HMGB2/PRIM1/E2F3/MSH6/CDK4/MCM3/DCK/TFDP1/FANCG/RFC3/MAPK13/SMC2 ## WP466 CDC45/MCM10/CDT1/MCM5/MCM2/CDC6/ORC6/ORC1/MCM6/MCM4/DBF4/RFC4/PCNA/GMNN/CDC7/POLE2/POLA2/MCM7/RFC2/PRIM1/PRIM2/MCM3/POLD1 ## WP45 CDC45/CDK1/CCNB1/MCM5/MCM2/CDC25A/CCNE1/ORC6/ORC1/CCNE2/MCM6/MCM4/MYC/PCNA/E2F1/CDKN2A/POLE2/POLA2/MCM7/PRIM1/E2F3/CDKN2C/CDK4/PRIM2/MCM3/TFDP1 ## WP2361 MYBL2/TOP2A/UBE2C/TPX2/S100P/AURKA/ECT2/KIF15/MCM4/CENPF/KIF20B/RUVBL1 ## WP4016 CDC45/FOXM1/CDK1/CHEK1/MCM2/PLK1/FANCI/EXO1/RAD51/FANCA/FEN1/PCNA/E2F1/RFWD3/MSH2/CDC25C/USP1/BRIP1/RMI1/SEM1/NBN/CLSPN/PARP1/H2AX As an alternative to manually downloading gmt files, install the rWikiPathways package to gain scripting access to the latest gmt files using the downloadPathwayArchive function. 11.3 Cell Marker cell_markers &lt;- vroom::vroom(&#39;http://bio-bigdata.hrbmu.edu.cn/CellMarker/download/Human_cell_markers.txt&#39;) %&gt;% tidyr::unite(&quot;cellMarker&quot;, tissueType, cancerType, cellName, sep=&quot;, &quot;) %&gt;% dplyr::select(cellMarker, geneID) %&gt;% dplyr::mutate(geneID = strsplit(geneID, &#39;, &#39;)) cell_markers ## # A tibble: 2,868 x 2 ## cellMarker geneID ## &lt;chr&gt; &lt;list&gt; ## 1 Kidney, Normal, Proximal tubular cell &lt;chr [1]&gt; ## 2 Liver, Normal, Ito cell (hepatic stellate cell) &lt;chr [1]&gt; ## 3 Endometrium, Normal, Trophoblast cell &lt;chr [1]&gt; ## 4 Germ, Normal, Primordial germ cell &lt;chr [1]&gt; ## 5 Corneal epithelium, Normal, Epithelial cell &lt;chr [1]&gt; ## 6 Placenta, Normal, Cytotrophoblast &lt;chr [1]&gt; ## 7 Periosteum, Normal, Periosteum-derived progenitor cell &lt;chr [4]&gt; ## 8 Amniotic membrane, Normal, Amnion epithelial cell &lt;chr [2]&gt; ## 9 Primitive streak, Normal, Primitive streak cell &lt;chr [2]&gt; ## 10 Adipose tissue, Normal, Stromal vascular fraction cell &lt;chr [1]&gt; ## # ‚Ä¶ with 2,858 more rows y &lt;- enricher(gene, TERM2GENE=cell_markers, minGSSize=1) DT::datatable(as.data.frame(y)) 11.4 MSigDb analysis Molecular Signatures Database contains 8 major collections: H: hallmark gene sets C1: positional gene sets C2: curated gene sets C3: motif gene sets C4: computational gene sets C5: GO gene sets C6: oncogenic signatures C7: immunologic signatures Users can download GMT files from Broad Institute and use read.gmt to parse the file to be used in enricher() and GSEA(). There is an R package, msigdbr, that already packed the MSigDB gene sets in tidy data format that can be used directly with clusterProfiler. It supports several specices: library(msigdbr) msigdbr_show_species() ## [1] &quot;Bos taurus&quot; &quot;Caenorhabditis elegans&quot; ## [3] &quot;Canis lupus familiaris&quot; &quot;Danio rerio&quot; ## [5] &quot;Drosophila melanogaster&quot; &quot;Gallus gallus&quot; ## [7] &quot;Homo sapiens&quot; &quot;Mus musculus&quot; ## [9] &quot;Rattus norvegicus&quot; &quot;Saccharomyces cerevisiae&quot; ## [11] &quot;Sus scrofa&quot; We can retrieve all human gene sets: m_df &lt;- msigdbr(species = &quot;Homo sapiens&quot;) head(m_df, 2) %&gt;% as.data.frame ## gs_id gs_name gs_cat gs_subcat human_gene_symbol species_name ## 1 M12609 AAACCAC_MIR140 C3 MIR:MIR_Legacy ABCC4 Homo sapiens ## 2 M12609 AAACCAC_MIR140 C3 MIR:MIR_Legacy ABRAXAS2 Homo sapiens ## entrez_gene gene_symbol sources ## 1 10257 ABCC4 &lt;NA&gt; ## 2 23172 ABRAXAS2 &lt;NA&gt; Or specific collection. Here we use C6, oncogenic gene sets as an example: m_t2g &lt;- msigdbr(species = &quot;Homo sapiens&quot;, category = &quot;C6&quot;) %&gt;% dplyr::select(gs_name, entrez_gene) head(m_t2g) ## # A tibble: 6 x 2 ## gs_name entrez_gene ## &lt;chr&gt; &lt;int&gt; ## 1 AKT_UP_MTOR_DN.V1_DN 25864 ## 2 AKT_UP_MTOR_DN.V1_DN 95 ## 3 AKT_UP_MTOR_DN.V1_DN 137872 ## 4 AKT_UP_MTOR_DN.V1_DN 134 ## 5 AKT_UP_MTOR_DN.V1_DN 55326 ## 6 AKT_UP_MTOR_DN.V1_DN 271 em &lt;- enricher(gene, TERM2GENE=m_t2g) em2 &lt;- GSEA(geneList, TERM2GENE = m_t2g) head(em) ## ID Description GeneRatio ## RPS14_DN.V1_DN RPS14_DN.V1_DN RPS14_DN.V1_DN 22/183 ## GCNP_SHH_UP_LATE.V1_UP GCNP_SHH_UP_LATE.V1_UP GCNP_SHH_UP_LATE.V1_UP 16/183 ## VEGF_A_UP.V1_DN VEGF_A_UP.V1_DN VEGF_A_UP.V1_DN 15/183 ## PRC2_EZH2_UP.V1_DN PRC2_EZH2_UP.V1_DN PRC2_EZH2_UP.V1_DN 14/183 ## E2F1_UP.V1_UP E2F1_UP.V1_UP E2F1_UP.V1_UP 12/183 ## ATF2_S_UP.V1_UP ATF2_S_UP.V1_UP ATF2_S_UP.V1_UP 12/183 ## BgRatio pvalue p.adjust qvalue ## RPS14_DN.V1_DN 184/10897 3.895275e-13 6.583014e-11 5.371379e-11 ## GCNP_SHH_UP_LATE.V1_UP 179/10897 5.086172e-08 4.297815e-06 3.506781e-06 ## VEGF_A_UP.V1_DN 192/10897 7.792893e-07 4.389997e-05 3.581997e-05 ## PRC2_EZH2_UP.V1_DN 189/10897 3.460639e-06 1.462120e-04 1.193010e-04 ## E2F1_UP.V1_UP 188/10897 7.640566e-05 2.264800e-03 1.847952e-03 ## ATF2_S_UP.V1_UP 189/10897 8.040709e-05 2.264800e-03 1.847952e-03 ## geneID ## RPS14_DN.V1_DN 10874/55388/991/9493/1062/4605/9133/23397/79733/9787/55872/83461/54821/51659/9319/9055/10112/4174/5105/2532/7021/79901 ## GCNP_SHH_UP_LATE.V1_UP 55388/7153/79733/6241/9787/51203/983/9212/1111/9319/9055/3833/6790/4174/3169/1580 ## VEGF_A_UP.V1_DN 8318/9493/1062/9133/10403/6241/9787/4085/332/3832/7272/891/23362/2167/10234 ## PRC2_EZH2_UP.V1_DN 8318/55388/4605/23397/9787/55355/10460/81620/2146/7272/9212/11182/3887/24137 ## E2F1_UP.V1_UP 55388/7153/23397/79733/9787/2146/2842/9212/8208/1111/9055/3833 ## ATF2_S_UP.V1_UP 4312/6280/2305/9493/7153/2146/10112/3887/8544/22885/10234/10974 ## Count ## RPS14_DN.V1_DN 22 ## GCNP_SHH_UP_LATE.V1_UP 16 ## VEGF_A_UP.V1_DN 15 ## PRC2_EZH2_UP.V1_DN 14 ## E2F1_UP.V1_UP 12 ## ATF2_S_UP.V1_UP 12 head(em2) ## ID Description setSize enrichmentScore ## CSR_LATE_UP.V1_UP CSR_LATE_UP.V1_UP CSR_LATE_UP.V1_UP 136 0.5952229 ## E2F1_UP.V1_UP E2F1_UP.V1_UP E2F1_UP.V1_UP 160 0.5311923 ## HOXA9_DN.V1_DN HOXA9_DN.V1_DN HOXA9_DN.V1_DN 181 0.5003226 ## MTOR_UP.V1_UP MTOR_UP.V1_UP MTOR_UP.V1_UP 130 0.5740249 ## RAF_UP.V1_DN RAF_UP.V1_DN RAF_UP.V1_DN 188 -0.5544683 ## RPS14_DN.V1_DN RPS14_DN.V1_DN RPS14_DN.V1_DN 182 0.5480207 ## NES pvalue p.adjust qvalues rank ## CSR_LATE_UP.V1_UP 2.546386 1e-10 3.15e-09 1.754386e-09 2105 ## E2F1_UP.V1_UP 2.304667 1e-10 3.15e-09 1.754386e-09 1592 ## HOXA9_DN.V1_DN 2.225542 1e-10 3.15e-09 1.754386e-09 1587 ## MTOR_UP.V1_UP 2.421092 1e-10 3.15e-09 1.754386e-09 1673 ## RAF_UP.V1_DN -2.254658 1e-10 3.15e-09 1.754386e-09 2035 ## RPS14_DN.V1_DN 2.441968 1e-10 3.15e-09 1.754386e-09 1278 ## leading_edge ## CSR_LATE_UP.V1_UP tags=52%, list=17%, signal=44% ## E2F1_UP.V1_UP tags=29%, list=13%, signal=26% ## HOXA9_DN.V1_DN tags=34%, list=13%, signal=30% ## MTOR_UP.V1_UP tags=42%, list=13%, signal=37% ## RAF_UP.V1_DN tags=44%, list=16%, signal=37% ## RPS14_DN.V1_DN tags=33%, list=10%, signal=30% ## core_enrichment ## CSR_LATE_UP.V1_UP 55143/2305/4605/6241/11065/55872/983/332/2146/9319/79801/990/11130/1503/51155/81831/2175/2237/56942/6627/84823/64785/6751/55055/51053/3608/3575/22808/8317/4496/7277/1841/5557/4502/4501/4172/5424/10606/11200/4828/6611/9123/10213/93081/7283/4522/8710/29902/4494/865/8662/86/63967/1020/5393/6921/55706/57019/6484/5702/6723/5708/54107/1000/5536/8089/7372/3814/4927/2280/22919 ## E2F1_UP.V1_UP 55388/7153/23397/79733/9787/2146/2842/9212/8208/1111/9055/3833/4001/419/7083/3149/10733/4173/2237/10926/7298/29078/699/6491/1763/1535/23649/58516/6541/1871/11169/1991/7884/5558/100/92154/23185/4678/9600/10592/7422/9100/1994/29802/142/117178/23076 ## HOXA9_DN.V1_DN 8318/55388/79733/55165/9582/9415/9837/81620/55765/5163/990/55215/875/4998/3070/10733/1717/54962/133/4597/9918/29028/84296/1690/1299/6713/7504/64785/55975/10535/55159/6576/55544/6515/55732/11314/586/30001/1749/3008/8530/7545/5558/55076/239/29923/11168/10849/9824/6696/3177/2189/6510/2289/57228/2824/9200/2713/55706/79071/29780 ## MTOR_UP.V1_UP 991/6241/11065/983/5163/4174/29968/11274/2001/51155/56649/6352/3070/7037/1717/4175/5214/10926/54962/2643/10437/6713/5111/9982/6614/27346/5268/55247/222255/3948/65260/136/3925/9388/3422/3162/2171/2224/637/467/9466/4939/6513/8807/55287/50814/4522/3434/147/3433/3336/3419/5550/1030/10801 ## RAF_UP.V1_DN 23314/221037/1960/51340/55105/10265/22996/9687/5357/1952/12/4602/9231/596/51454/57419/595/4256/23022/8777/7837/7042/3397/57613/323/1831/6451/54843/7358/2353/8773/6938/8991/64699/57007/23389/10560/7227/3485/79068/10769/4254/26018/3480/2674/23327/857/116039/6542/2690/1955/1363/26353/7033/5376/89927/51363/8821/2239/6947/4886/214/3487/3667/5157/54847/54898/7031/6505/57535/10451/18/771/80129/5174/5507/56521/8839/8614/5241/10551/57758 ## RPS14_DN.V1_DN 10874/55388/991/9493/1062/4605/9133/23397/79733/9787/55872/83461/54821/51659/9319/9055/10112/4174/29968/11004/990/5347/55635/9156/875/1894/9700/7083/79094/56992/4998/4288/440/200315/29028/55975/26271/55055/3574/705/23109/51337/6535/51083/4436/6182/586/8877/119/4072/23481/9631/5424/2140/1317/9824/5831/3177/7283/51154 We can test with other collections, for example, using C3 to test whether the genes are up/down-regulated by sharing specific motif. m_t2g &lt;- msigdbr(species = &quot;Homo sapiens&quot;, category = &quot;C3&quot;) %&gt;% dplyr::select(gs_name, entrez_gene) head(m_t2g) ## # A tibble: 6 x 2 ## gs_name entrez_gene ## &lt;chr&gt; &lt;int&gt; ## 1 AAACCAC_MIR140 10257 ## 2 AAACCAC_MIR140 23172 ## 3 AAACCAC_MIR140 81 ## 4 AAACCAC_MIR140 90 ## 5 AAACCAC_MIR140 8754 ## 6 AAACCAC_MIR140 11096 em3 &lt;- GSEA(geneList, TERM2GENE = m_t2g) head(em3) ## ID Description setSize ## E2F1_Q3 E2F1_Q3 E2F1_Q3 186 ## E2F1_Q6 E2F1_Q6 E2F1_Q6 183 ## HSD17B8_TARGET_GENES HSD17B8_TARGET_GENES HSD17B8_TARGET_GENES 400 ## SGCGSSAAA_E2F1DP2_01 SGCGSSAAA_E2F1DP2_01 SGCGSSAAA_E2F1DP2_01 128 ## E2F_Q4 E2F_Q4 E2F_Q4 189 ## E2F_Q6 E2F_Q6 E2F_Q6 186 ## enrichmentScore NES pvalue p.adjust ## E2F1_Q3 0.5010091 2.209767 1.000000e-10 1.102000e-07 ## E2F1_Q6 0.4982840 2.199817 1.000000e-10 1.102000e-07 ## HSD17B8_TARGET_GENES 0.6375083 3.079621 1.000000e-10 1.102000e-07 ## SGCGSSAAA_E2F1DP2_01 0.5448603 2.313417 3.178136e-10 2.626730e-07 ## E2F_Q4 0.4771367 2.102162 5.779393e-10 3.821335e-07 ## E2F_Q6 0.4758875 2.098965 9.329650e-10 5.140637e-07 ## qvalues rank leading_edge ## E2F1_Q3 8.673684e-08 2045 tags=36%, list=16%, signal=31% ## E2F1_Q6 8.673684e-08 2240 tags=39%, list=18%, signal=32% ## HSD17B8_TARGET_GENES 8.673684e-08 1042 tags=36%, list=8%, signal=34% ## SGCGSSAAA_E2F1DP2_01 2.067461e-07 1797 tags=38%, list=14%, signal=33% ## E2F_Q4 3.007718e-07 1663 tags=30%, list=13%, signal=26% ## E2F_Q6 4.046122e-07 1663 tags=30%, list=13%, signal=26% ## core_enrichment ## E2F1_Q3 79733/6241/983/5080/2146/8715/4171/993/990/56992/9768/4998/10733/7037/4175/54962/54954/29028/3015/2643/85236/5111/64785/26271/51053/1869/3925/114/5427/4176/7112/4436/1871/79915/9088/6632/284403/7290/2597/7398/4172/5424/124222/1633/10849/9824/4678/6646/29902/63967/56886/6059/23234/1786/204/51087/23636/2048/83463/10393/79173/688/3007/79677/9462/56946/9221 ## E2F1_Q6 79733/6241/983/5080/81620/2146/4171/993/990/3159/9768/4998/4175/4173/29028/3015/4609/85236/5111/64785/26271/51053/1869/3925/5427/4176/7112/5902/4436/1871/79915/9088/6632/284403/7290/2597/4172/5424/124222/1633/10849/7374/9824/2189/4678/2289/6646/29902/50/63967/56886/23234/6839/1786/204/51087/23636/11335/1174/83463/10492/79173/688/79677/9462/56946/9221/5933/26135/988/5591 ## HSD17B8_TARGET_GENES 55143/55388/991/2305/9493/1062/4605/9833/9133/10403/7153/23397/79733/259266/6241/55165/9787/11065/55355/9582/220134/55872/83461/10460/4751/10635/55839/890/9415/983/54821/4085/9837/5080/332/7272/64151/2842/9212/51659/9319/9055/3833/146909/10112/51514/4174/9232/1033/9928/3161/11004/993/4603/79801/990/5347/55215/701/55723/51512/55635/9156/11130/10024/57405/10615/1894/2491/8438/9700/5888/7083/898/3149/56992/9768/4288/10733/1163/4175/5307/2237/29899/55010/59336/56942/5984/29028/3838/1058/54478/3015/699/6491/81611/1063/27346/64785/9401/26271/51026/641/1869/10535/1029/28998/1763/8970/54892/55159/864/93594/1789/4176/7111/3148/116832/9585/9735/55732/81624/23310/1871/1031/79915/995/10051/30012/1104/80178/78995/7468/284403/5230/8549/7884/5558/4172/5424/79866/3182/56902/83990 ## SGCGSSAAA_E2F1DP2_01 79733/6241/4171/993/990/3159/9768/4175/4173/29028/3015/4609/85236/5111/64785/26271/51053/1869/5427/4176/5902/4436/1871/79915/9088/6632/284403/7290/4172/5424/124222/1633/7374/2189/4678/2289/50/63967/56886/23234/6839/1786/204/51087/23636/1174/83463/10492/79173 ## E2F_Q4 8318/79733/6241/983/5080/81620/2146/4171/993/990/5888/9768/4175/4173/29028/3015/85236/5111/64785/26271/51053/1869/3925/5427/23649/4176/7112/5902/4436/1871/79915/9088/6632/284403/7290/2597/4172/5424/124222/1633/10849/7473/7374/9824/7353/4678/6646/50/63967/56886/23234/1786/204/6427/51087/23636 ## E2F_Q6 8318/79733/6241/983/5080/81620/2146/4171/993/990/5888/9768/4175/4173/29028/3015/85236/5111/64785/26271/51053/1869/3925/5427/23649/4176/7112/5902/4436/1871/79915/9088/6632/284403/7290/2597/4172/5424/124222/1633/10849/7374/9824/7353/4678/6646/50/63967/56886/23234/1786/204/6427/51087/23636 11.5 MSigDb The MSigDB is a collection of annotated gene sets, it include 8 major collections: H: hallmark gene sets C1: positional gene sets C2: curated gene sets C3: motif gene sets C4: computational gene sets C5: GO gene sets C6: oncogenic signatures C7: immunologic signatures Users can use enricher and GSEA function to analyze gene set collections downloaded from Molecular Signatures Database (MSigDb). clusterProfiler provides a function, read.gmt, to parse the gmt file into a TERM2GENE data.frame that is ready for both enricher and GSEA functions. data(geneList, package=&quot;DOSE&quot;) gene &lt;- names(geneList)[abs(geneList) &gt; 2] gmtfile &lt;- system.file(&quot;extdata&quot;, &quot;c5.cc.v5.0.entrez.gmt&quot;, package=&quot;clusterProfiler&quot;) c5 &lt;- read.gmt(gmtfile) egmt &lt;- enricher(gene, TERM2GENE=c5) head(egmt) ## ID Description ## SPINDLE SPINDLE SPINDLE ## MICROTUBULE_CYTOSKELETON MICROTUBULE_CYTOSKELETON MICROTUBULE_CYTOSKELETON ## CYTOSKELETAL_PART CYTOSKELETAL_PART CYTOSKELETAL_PART ## SPINDLE_MICROTUBULE SPINDLE_MICROTUBULE SPINDLE_MICROTUBULE ## MICROTUBULE MICROTUBULE MICROTUBULE ## CYTOSKELETON CYTOSKELETON CYTOSKELETON ## GeneRatio BgRatio pvalue p.adjust ## SPINDLE 11/82 39/5270 7.667674e-12 5.214018e-10 ## MICROTUBULE_CYTOSKELETON 16/82 152/5270 8.449298e-10 2.872761e-08 ## CYTOSKELETAL_PART 15/82 235/5270 2.414879e-06 5.237096e-05 ## SPINDLE_MICROTUBULE 5/82 16/5270 3.080645e-06 5.237096e-05 ## MICROTUBULE 6/82 32/5270 7.740446e-06 1.052701e-04 ## CYTOSKELETON 16/82 367/5270 1.308357e-04 1.482805e-03 ## qvalue ## SPINDLE 4.197043e-10 ## MICROTUBULE_CYTOSKELETON 2.312439e-08 ## CYTOSKELETAL_PART 4.215619e-05 ## SPINDLE_MICROTUBULE 4.215619e-05 ## MICROTUBULE 8.473751e-05 ## CYTOSKELETON 1.193589e-03 ## geneID ## SPINDLE 991/9493/9787/22974/983/332/3832/7272/9055/6790/24137 ## MICROTUBULE_CYTOSKELETON 991/9493/9133/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802 ## CYTOSKELETAL_PART 991/9493/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802 ## SPINDLE_MICROTUBULE 983/332/3832/9055/24137 ## MICROTUBULE 983/332/3832/9055/24137/4137 ## CYTOSKELETON 991/9493/9133/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802 ## Count ## SPINDLE 11 ## MICROTUBULE_CYTOSKELETON 16 ## CYTOSKELETAL_PART 15 ## SPINDLE_MICROTUBULE 5 ## MICROTUBULE 6 ## CYTOSKELETON 16 egmt2 &lt;- GSEA(geneList, TERM2GENE=c5, verbose=FALSE) head(egmt2) ## ID ## CHROMOSOMAL_PART CHROMOSOMAL_PART ## CHROMOSOME CHROMOSOME ## EXTRACELLULAR_MATRIX EXTRACELLULAR_MATRIX ## PROTEINACEOUS_EXTRACELLULAR_MATRIX PROTEINACEOUS_EXTRACELLULAR_MATRIX ## SPINDLE SPINDLE ## CHROMOSOMEPERICENTRIC_REGION CHROMOSOMEPERICENTRIC_REGION ## Description setSize ## CHROMOSOMAL_PART CHROMOSOMAL_PART 87 ## CHROMOSOME CHROMOSOME 112 ## EXTRACELLULAR_MATRIX EXTRACELLULAR_MATRIX 95 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX PROTEINACEOUS_EXTRACELLULAR_MATRIX 93 ## SPINDLE SPINDLE 37 ## CHROMOSOMEPERICENTRIC_REGION CHROMOSOMEPERICENTRIC_REGION 30 ## enrichmentScore NES pvalue ## CHROMOSOMAL_PART 0.6306975 2.475091 1.000000e-10 ## CHROMOSOME 0.6136947 2.530656 1.000000e-10 ## EXTRACELLULAR_MATRIX -0.6229461 -2.328695 1.000000e-10 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX -0.6355317 -2.368120 1.000000e-10 ## SPINDLE 0.7512846 2.511292 3.137532e-09 ## CHROMOSOMEPERICENTRIC_REGION 0.7846974 2.466684 6.169728e-09 ## p.adjust qvalues rank ## CHROMOSOMAL_PART 4.850000e-09 3.789474e-09 1681 ## CHROMOSOME 4.850000e-09 3.789474e-09 1905 ## EXTRACELLULAR_MATRIX 4.850000e-09 3.789474e-09 1473 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX 4.850000e-09 3.789474e-09 1473 ## SPINDLE 1.217362e-07 9.511676e-08 759 ## CHROMOSOMEPERICENTRIC_REGION 1.994879e-07 1.558668e-07 730 ## leading_edge ## CHROMOSOMAL_PART tags=38%, list=13%, signal=33% ## CHROMOSOME tags=38%, list=15%, signal=33% ## EXTRACELLULAR_MATRIX tags=48%, list=12%, signal=43% ## PROTEINACEOUS_EXTRACELLULAR_MATRIX tags=49%, list=12%, signal=44% ## SPINDLE tags=43%, list=6%, signal=41% ## CHROMOSOMEPERICENTRIC_REGION tags=40%, list=6%, signal=38% ## core_enrichment ## CHROMOSOMAL_PART 1062/10403/4085/81620/332/4171/701/11130/11339/3070/54962/5984/1058/699/1063/5111/55055/55506/4176/7112/2296/79980/5982/10051/1104/4172/2072/5983/10592/8914/1788/4613/3619 ## CHROMOSOME 1062/10403/7153/4085/81620/332/1111/4171/701/11130/5888/11339/3070/54962/5984/9918/1058/699/1063/5111/55055/55506/4176/7112/2296/3148/79980/5982/10051/1104/4172/2072/7283/5983/10592/8914/1788/6839/4613/3619/5901/7273/6119 ## EXTRACELLULAR_MATRIX 80781/1490/1306/8425/8082/4256/8910/3912/1278/4060/283/30008/5549/22795/10516/1293/1295/2192/1281/50509/4319/1290/11096/2202/2199/6444/1294/1462/1289/3908/3909/4053/8292/1842/10631/2331/3730/3913/1300/2200/1287/7060/1307/1311/4148/1101 ## PROTEINACEOUS_EXTRACELLULAR_MATRIX 80781/1490/1306/8425/8082/4256/8910/3912/1278/4060/283/30008/5549/22795/10516/1293/1295/2192/1281/50509/4319/1290/11096/2202/2199/6444/1294/1462/1289/3908/3909/4053/8292/1842/10631/2331/3730/3913/1300/2200/1287/7060/1307/1311/4148/1101 ## SPINDLE 991/9493/9787/22974/983/332/3832/7272/9055/6790/24137/699/1063/26271/29901/9735 ## CHROMOSOMEPERICENTRIC_REGION 1062/10403/4085/332/701/11130/3070/1058/699/1063/55055/79980 "],
["chipseeker-enrichment.html", "Chapter 12 Functional enrichment analysis of genomic coordinations", " Chapter 12 Functional enrichment analysis of genomic coordinations Functional analysis using NGS data (eg, RNA-Seq and ChIP-Seq) can be performed by linking coding and non-coding regions to coding genes via ChIPseeker(G. Yu, Wang, and He 2015) package, which can annotates genomic regions to their nearest genes, host genes, and flanking genes respectivly. In addtion, it provides a function, seq2gene, that simultaneously considering host genes, promoter region and flanking gene from intergenic region that may under control via cis-regulation. This function maps genomic regions to genes in a many-to-many manner and facilitate functional analysis. For more details, please refer to ChIPseeker(G. Yu, Wang, and He 2015). References "],
["clusterprofiler-comparecluster.html", "Chapter 13 Biological theme comparison 13.1 Formula interface of compareCluster 13.2 Visualization of profile comparison", " Chapter 13 Biological theme comparison clusterProfiler was developed for biological theme comparison(Yu et al. 2012), and it provides a function, compareCluster, to automatically calculate enriched functional categories of each gene clusters. data(gcSample) lapply(gcSample, head) ## $X1 ## [1] &quot;4597&quot; &quot;7111&quot; &quot;5266&quot; &quot;2175&quot; &quot;755&quot; &quot;23046&quot; ## ## $X2 ## [1] &quot;23450&quot; &quot;5160&quot; &quot;7126&quot; &quot;26118&quot; &quot;8452&quot; &quot;3675&quot; ## ## $X3 ## [1] &quot;894&quot; &quot;7057&quot; &quot;22906&quot; &quot;3339&quot; &quot;10449&quot; &quot;6566&quot; ## ## $X4 ## [1] &quot;5573&quot; &quot;7453&quot; &quot;5245&quot; &quot;23450&quot; &quot;6500&quot; &quot;4926&quot; ## ## $X5 ## [1] &quot;5982&quot; &quot;7318&quot; &quot;6352&quot; &quot;2101&quot; &quot;8882&quot; &quot;7803&quot; ## ## $X6 ## [1] &quot;5337&quot; &quot;9295&quot; &quot;4035&quot; &quot;811&quot; &quot;23365&quot; &quot;4629&quot; ## ## $X7 ## [1] &quot;2621&quot; &quot;2665&quot; &quot;5690&quot; &quot;3608&quot; &quot;3550&quot; &quot;533&quot; ## ## $X8 ## [1] &quot;2665&quot; &quot;4735&quot; &quot;1327&quot; &quot;3192&quot; &quot;5573&quot; &quot;9528&quot; The input for geneCluster parameter should be a named list of gene IDs. To speed up the compilation of this document, we set use_internal_data = TRUE. ck &lt;- compareCluster(geneCluster = gcSample, fun = &quot;enrichKEGG&quot;) head(as.data.frame(ck)) ## Cluster ID Description GeneRatio BgRatio ## 1 X2 hsa04110 Cell cycle 18/377 124/8063 ## 2 X2 hsa05169 Epstein-Barr virus infection 23/377 202/8063 ## 3 X2 hsa05340 Primary immunodeficiency 8/377 38/8063 ## 4 X2 hsa05166 Human T-cell leukemia virus 1 infection 22/377 219/8063 ## 5 X3 hsa04512 ECM-receptor interaction 9/185 88/8063 ## 6 X3 hsa04060 Cytokine-cytokine receptor interaction 17/185 294/8063 ## pvalue p.adjust qvalue ## 1 1.633160e-05 0.004834153 0.004504083 ## 2 6.454464e-05 0.009552607 0.008900366 ## 3 3.014145e-04 0.029739564 0.027708982 ## 4 5.601779e-04 0.041453162 0.038622790 ## 5 1.739917e-04 0.040576319 0.037764589 ## 6 4.040556e-04 0.040576319 0.037764589 ## geneID ## 1 991/1869/890/1871/701/990/10926/9088/8317/9700/9134/1029/2810/699/11200/23594/8555/4173 ## 2 4067/3383/7128/1869/890/1871/578/864/637/9641/6891/355/9134/5971/916/956/6850/7187/3551/919/4734/958/6772 ## 3 100/6891/3932/973/916/925/958/64421 ## 4 3383/991/1869/890/1871/113/701/9700/3932/9134/5971/916/4487/3600/1029/3551/8498/4488/11200/4776/4214/958 ## 5 7057/3339/1299/3695/1101/3679/3910/3696/3693 ## 6 2919/4982/3977/6375/8200/608/8792/3568/2057/1438/8718/655/652/10220/50615/51561/7042 ## Count ## 1 18 ## 2 23 ## 3 8 ## 4 22 ## 5 9 ## 6 17 13.1 Formula interface of compareCluster compareCluster also supports passing a formula (the code to support formula has been contributed by Giovanni Dall‚ÄôOlio) of type \\(Entrez \\sim group\\) or \\(Entrez \\sim group + othergroup\\). mydf &lt;- data.frame(Entrez=names(geneList), FC=geneList) mydf &lt;- mydf[abs(mydf$FC) &gt; 1,] mydf$group &lt;- &quot;upregulated&quot; mydf$group[mydf$FC &lt; 0] &lt;- &quot;downregulated&quot; mydf$othergroup &lt;- &quot;A&quot; mydf$othergroup[abs(mydf$FC) &gt; 2] &lt;- &quot;B&quot; formula_res &lt;- compareCluster(Entrez~group+othergroup, data=mydf, fun=&quot;enrichKEGG&quot;) head(as.data.frame(formula_res)) ## Cluster group othergroup ID ## 1 downregulated.A downregulated A hsa04974 ## 2 downregulated.A downregulated A hsa04510 ## 3 downregulated.A downregulated A hsa04151 ## 4 downregulated.A downregulated A hsa04512 ## 5 downregulated.B downregulated B hsa03320 ## 6 upregulated.A upregulated A hsa04110 ## Description GeneRatio BgRatio pvalue p.adjust ## 1 Protein digestion and absorption 16/313 103/8063 1.900162e-06 5.130437e-04 ## 2 Focal adhesion 20/313 201/8063 9.894603e-05 1.335771e-02 ## 3 PI3K-Akt signaling pathway 28/313 354/8063 2.512699e-04 2.261429e-02 ## 4 ECM-receptor interaction 11/313 88/8063 5.601739e-04 3.781174e-02 ## 5 PPAR signaling pathway 5/42 77/8063 4.496598e-05 6.789863e-03 ## 6 Cell cycle 20/219 124/8063 9.983412e-11 2.415986e-08 ## qvalue ## 1 4.820411e-04 ## 2 1.255052e-02 ## 3 2.124774e-02 ## 4 3.552682e-02 ## 5 6.295238e-03 ## 6 2.164824e-08 ## geneID ## 1 1281/50509/1290/477/1294/1360/1289/1292/1296/23428/1359/1300/1287/6505/2006/7373 ## 2 55742/2317/7058/25759/56034/3693/3480/5159/857/1292/3908/3909/63923/3913/1287/3679/7060/3479/10451/80310 ## 3 55970/5618/7058/10161/56034/3693/4254/3480/4908/5159/1292/3908/2690/3909/8817/9223/4915/3551/2791/63923/3913/9863/3667/1287/3679/7060/3479/80310 ## 4 7058/3693/3339/1292/3908/3909/63923/3913/1287/3679/7060 ## 5 9370/5105/2167/3158/5346 ## 6 4171/993/990/5347/701/9700/898/23594/4998/9134/4175/4173/10926/6502/994/699/4609/5111/1869/1029 ## Count ## 1 16 ## 2 20 ## 3 28 ## 4 11 ## 5 5 ## 6 20 13.2 Visualization of profile comparison We can visualize the result using dotplot method. dotplot(ck) dotplot(formula_res) dotplot(formula_res, x=~group) + ggplot2::facet_grid(~othergroup) By default, only top 5 (most significant) categories of each cluster was plotted. User can changes the parameter showCategory to specify how many categories of each cluster to be plotted, and if showCategory was set to NULL, the whole result will be plotted. The plot function accepts a parameter by for setting the scale of dot sizes. The default parameter by is setting to ‚ÄúgeneRatio‚Äù, which corresponding to the ‚ÄúGeneRatio‚Äù column of the output. If it was setting to count, the comparison will be based on gene counts, while if setting to rowPercentage, the dot sizes will be normalized by count/(sum of each row) To provide the full information, we also provide number of identified genes in each category (numbers in parentheses) when by is setting to rowPercentage and number of gene clusters in each cluster label (numbers in parentheses) when by is setting to geneRatio, as shown in Figure 3. If the dot sizes were based on count, the row numbers will not shown. The p-values indicate that which categories are more likely to have biological meanings. The dots in the plot are color-coded based on their corresponding p-values. Color gradient ranging from red to blue correspond to in order of increasing p-values. That is, red indicate low p-values (high enrichment), and blue indicate high p-values (low enrichment). P-values and adjusted p-values were filtered out by the threshold giving by parameter pvalueCutoff, and FDR can be estimated by qvalue. User can refer to the example in Yu (2012)(Yu et al. 2012); we analyzed the publicly available expression dataset of breast tumour tissues from 200 patients (GSE11121, Gene Expression Omnibus)(Schmidt et al. 2008). We identified 8 gene clusters from differentially expressed genes, and using compareCluster to compare these gene clusters by their enriched biological process. The comparison function was designed as a framework for comparing gene clusters of any kind of ontology associations, not only groupGO, enrichGO, enrichKEGG and enricher provided in this package, but also other biological and biomedical ontologies, for instance, enrichDO from DOSE(G. Yu et al. 2015), enrichMeSH from meshes and enrichPathway from ReactomePA work fine with compareCluster for comparing biological themes in disease and reactome pathway perspective. More details can be found in the vignettes of DOSE(G. Yu et al. 2015) and ReactomePA. References "],
["enrichplot.html", "Chapter 14 Visualization of functional enrichment result 14.1 Bar Plot 14.2 Dot plot 14.3 Gene-Concept Network 14.4 Heatmap-like functional classification 14.5 Enrichment Map 14.6 UpSet Plot 14.7 ridgeline plot for expression distribution of GSEA result 14.8 running score and preranked list of GSEA result 14.9 pubmed trend of enriched terms 14.10 goplot 14.11 browseKEGG 14.12 pathview from pathview package", " Chapter 14 Visualization of functional enrichment result The enrichplot package implements several visualization methods to help interpreting enrichment results. It supports visualizing enrichment results obtained from DOSE (G. Yu et al. 2015), clusterProfiler (Yu et al. 2012), ReactomePA (Yu and He 2016) and meshes. Both over representation analysis (ORA) and gene set enrichment analysis (GSEA) are supported. Many of these visualization methods were first implemented in DOSE and rewrote from scratch using ggplot2. If you want to use old methods2, you can use the doseplot package. 14.1 Bar Plot Bar plot is the most widely used method to visualize enriched terms. It depicts the enrichment scores (e.g. p values) and gene count or ratio as bar height and color. library(DOSE) data(geneList) de &lt;- names(geneList)[abs(geneList) &gt; 2] edo &lt;- enrichDGN(de) library(enrichplot) barplot(edo, showCategory=20) Figure 14.1: Bar plot of enriched terms. 14.2 Dot plot Dot plot is similar to bar plot with the capability to encode another score as dot size. edo2 &lt;- gseDO(geneList) p1 &lt;- dotplot(edo, showCategory=30) + ggtitle(&quot;dotplot for ORA&quot;) p2 &lt;- dotplot(edo2, showCategory=30) + ggtitle(&quot;dotplot for GSEA&quot;) plot_grid(p1, p2, ncol=2) Figure 14.2: Dot plot of enriched terms. 14.3 Gene-Concept Network Both the barplot and dotplot only displayed most significant enriched terms, while users may want to know which genes are involved in these significant terms. In order to consider the potentially biological complexities in which a gene may belong to multiple annotation categories and provide information of numeric changes if available, we developed cnetplot function to extract the complex association. The cnetplot depicts the linkages of genes and biological concepts (e.g. GO terms or KEGG pathways) as a network. GSEA result is also supported with only core enriched genes displayed. ## convert gene ID to Symbol edox &lt;- setReadable(edo, &#39;org.Hs.eg.db&#39;, &#39;ENTREZID&#39;) p1 &lt;- cnetplot(edox, foldChange=geneList) ## categorySize can be scaled by &#39;pvalue&#39; or &#39;geneNum&#39; p2 &lt;- cnetplot(edox, categorySize=&quot;pvalue&quot;, foldChange=geneList) p3 &lt;- cnetplot(edox, foldChange=geneList, circular = TRUE, colorEdge = TRUE) cowplot::plot_grid(p1, p2, p3, ncol=3, labels=LETTERS[1:3], rel_widths=c(.8, .8, 1.2)) Figure 14.3: Network plot of enriched terms. If you would like label subset of the nodes, you can use the node_label parameter, which supports 4 possible selections (i.e.¬†‚Äúcategory‚Äù, ‚Äúgene‚Äù, ‚Äúall‚Äù and ‚Äúnone‚Äù), as demonstrated in Figure 14.4. p1 &lt;- cnetplot(edox, node_label=&quot;category&quot;) p2 &lt;- cnetplot(edox, node_label=&quot;gene&quot;) p3 &lt;- cnetplot(edox, node_label=&quot;all&quot;) p4 &lt;- cnetplot(edox, node_label=&quot;none&quot;) cowplot::plot_grid(p1, p2, p3, p4, ncol=2, labels=LETTERS[1:4]) Figure 14.4: Labelling nodes by selected subset. gene category (A), gene name (B), both gene category and gene name (C, default) and not to label at all (D). 14.4 Heatmap-like functional classification The heatplot is similar to cnetplot, while displaying the relationships as a heatmap. The gene-concept network may become too complicated if user want to show a large number significant terms. The heatplot can simplify the result and more easy to identify expression patterns. p1 &lt;- heatplot(edox) p2 &lt;- heatplot(edox, foldChange=geneList) cowplot::plot_grid(p1, p2, ncol=1, labels=LETTERS[1:2]) Figure 14.5: Heatmap plot of enriched terms. default (A), foldChange=geneList (B) 14.5 Enrichment Map Enrichment map organizes enriched terms into a network with edges connecting overlapping gene sets. In this way, mutually overlapping gene sets are tend to cluster together, making it easy to identify functional module. The emapplot function supports results obtained from hypergeometric test and gene set enrichment analysis. The pie_scale parameter can be used to resize nodes, as demonstrated in Figure 14.6 B, and the layout parameter can adjust the layout, as demonstrated in Figure 14.6 C and D. p1 &lt;- emapplot(edo) p2 &lt;- emapplot(edo, pie_scale=1.5) p3 &lt;- emapplot(edo,layout=&quot;kk&quot;) p4 &lt;- emapplot(edo, pie_scale=1.5,layout=&quot;kk&quot;) cowplot::plot_grid(p1, p2, p3, p4, ncol=2, labels=LETTERS[1:4]) Figure 14.6: Plot for results obtained from hypergeometric test and gene set enrichment analysis. default (A), pie_scale=1.5 (B), layout=\"kk\" (C) and pie_scale=1.5,layout=\"kk\" (D). The emapplot function also supports results obtained from compareCluster function of clusterProfiler package. In addition to pie_scale and layout parameters, the number of circles in the bottom left corner can be adjusted using the legend_n parameteras, as demonstrated in Figure 14.7 B. And proportion of clusters in the pie chart can be adjusted using the pie parameter, when pie=\"count\", the proportion of clusters in the pie chart is determined by the number of genes, as demonstrated in Figure 14.7 C and D. library(clusterProfiler) data(gcSample) xx &lt;- compareCluster(gcSample, fun=&quot;enrichKEGG&quot;, organism=&quot;hsa&quot;, pvalueCutoff=0.05) p1 &lt;- emapplot(xx) p2 &lt;- emapplot(xx,legend_n=2) p3 &lt;- emapplot(xx,pie=&quot;count&quot;) p4 &lt;- emapplot(xx,pie=&quot;count&quot;, pie_scale=1.5, layout=&quot;kk&quot;) cowplot::plot_grid(p1, p2, p3, p4, ncol=2, labels=LETTERS[1:4]) Figure 14.7: Plot for results obtained from compareCluster function of clusterProfiler package. default (A), legend_n=2 (B), pie=\"count\" (C) and pie=\"count\", pie_scale=1.5, layout=\"kk\" (D). 14.6 UpSet Plot The upsetplot is an alternative to cnetplot for visualizing the complex association between genes and gene sets. It emphasizes the gene overlapping among different gene sets. upsetplot(edo) Figure 14.8: Upsetplot for over-representation analysis. For over-representation analysis, upsetplot will calculate the overlaps among different gene sets as demonstrated in Figure 14.8. For GSEA result, it will plot the fold change distributions of different categories (e.g.¬†unique to pathway, overlaps among different pathways). upsetplot(kk2) Figure 14.9: Upsetplot for gene set enrichment analysis. 14.7 ridgeline plot for expression distribution of GSEA result The ridgeplot will visualize expression distributions of core enriched genes for GSEA enriched categories. It helps users to interpret up/down-regulated pathways. ridgeplot(edo2) Figure 14.10: Ridgeplot for gene set enrichment analysis. 14.8 running score and preranked list of GSEA result Running score and preranked list are traditional methods for visualizing GSEA result. The enrichplot package supports both of them to visualize the distribution of the gene set and the enrichment score. p1 &lt;- gseaplot(edo2, geneSetID = 1, by = &quot;runningScore&quot;, title = edo2$Description[1]) p2 &lt;- gseaplot(edo2, geneSetID = 1, by = &quot;preranked&quot;, title = edo2$Description[1]) p3 &lt;- gseaplot(edo2, geneSetID = 1, title = edo2$Description[1]) cowplot::plot_grid(p1, p2, p3, ncol=1, labels=LETTERS[1:3]) Figure 14.11: gseaplot for GSEA result(by = \"runningScore\"). by = \"runningScore\" (A), by = \"preranked\" (B), default (C) Another method to plot GSEA result is the gseaplot2 function: gseaplot2(edo2, geneSetID = 1, title = edo2$Description[1]) Figure 14.12: Gseaplot2 for GSEA result. The gseaplot2 also supports multile gene sets to be displayed on the same figure: gseaplot2(edo2, geneSetID = 1:3) Figure 14.13: Gseaplot2 for GSEA result of multile gene sets. User can also displaying the pvalue table on the plot via pvalue_table parameter: gseaplot2(edo2, geneSetID = 1:3, pvalue_table = TRUE, color = c(&quot;#E495A5&quot;, &quot;#86B875&quot;, &quot;#7DB0DD&quot;), ES_geom = &quot;dot&quot;) Figure 14.14: Gseaplot2 for GSEA result of multile gene sets(add pvalue_table). User can specify subplots to only display a subset of plots: p1 &lt;- gseaplot2(edo2, geneSetID = 1:3, subplots = 1) p2 &lt;- gseaplot2(edo2, geneSetID = 1:3, subplots = 1:2) cowplot::plot_grid(p1, p2, ncol=1, labels=LETTERS[1:2]) Figure 14.15: Gseaplot2 for GSEA result of multile gene sets(add subplots). subplots = 1 (A),subplots = 1:2 (B) The gsearank function plot the ranked list of genes belong to the specific gene set. gsearank(edo2, 1, title = edo2[1, &quot;Description&quot;]) Figure 14.16: Ranked list of genes belong to the specific gene set. Multiple gene sets can be aligned using cowplot: (ref:gsearank2scap) Gsearank for multiple gene sets. library(ggplot2) library(cowplot) pp &lt;- lapply(1:3, function(i) { anno &lt;- edo2[i, c(&quot;NES&quot;, &quot;pvalue&quot;, &quot;p.adjust&quot;)] lab &lt;- paste0(names(anno), &quot;=&quot;, round(anno, 3), collapse=&quot;\\n&quot;) gsearank(edo2, i, edo2[i, 2]) + xlab(NULL) +ylab(NULL) + annotate(&quot;text&quot;, 0, edo2[i, &quot;enrichmentScore&quot;] * .9, label = lab, hjust=0, vjust=0) }) plot_grid(plotlist=pp, ncol=1) Figure 14.17: Gsearank for multiple gene sets. 14.9 pubmed trend of enriched terms One of the problem of enrichment analysis is to find pathways for further investigation. Here, we provide pmcplot function to plot the number/proportion of publications trend based on the query result from PubMed Central. Of course, users can use pmcplot in other scenarios. All text that can be queried on PMC is valid as input of pmcplot. terms &lt;- edo$Description[1:3] p &lt;- pmcplot(terms, 2010:2017) p2 &lt;- pmcplot(terms, 2010:2017, proportion=FALSE) plot_grid(p, p2, ncol=2) Figure 14.18: Pmcplot of enrichment analysis. 14.10 goplot goplot can accept output of enrichGO and visualized the enriched GO induced graph. goplot(ego) 14.11 browseKEGG To view the KEGG pathway, user can use browseKEGG function, which will open web browser and highlight enriched genes. browseKEGG(kk, &#39;hsa04110&#39;) 14.12 pathview from pathview package clusterProfiler users can also use pathview from the pathview(Luo and Brouwer 2013) to visualize KEGG pathway. The following example illustrate how to visualize ‚Äúhsa04110‚Äù pathway, which was enriched in our previous analysis. library(&quot;pathview&quot;) hsa04110 &lt;- pathview(gene.data = geneList, pathway.id = &quot;hsa04110&quot;, species = &quot;hsa&quot;, limit = list(gene=max(abs(geneList)), cpd=1)) For further information, please refer to the vignette of pathview(Luo and Brouwer 2013). References "],
["clusterProfiler-dplyr.html", "Chapter 15 dplyr verbs for manipulating enrichment result 15.1 filter 15.2 arrange 15.3 select 15.4 mutate 15.5 slice 15.6 summarise", " Chapter 15 dplyr verbs for manipulating enrichment result library(DOSE) data(geneList) de = names(geneList)[1:100] x = enrichDO(de) 15.1 filter filter(x, p.adjust &lt; .05, qvalue &lt; 0.2) ## # ## # over-representation test ## # ## #...@organism Homo sapiens ## #...@ontology DO ## #...@keytype ENTREZID ## #...@gene chr [1:100] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; &quot;991&quot; &quot;6280&quot; &quot;2305&quot; ... ## #...pvalues adjusted by &#39;BH&#39; with cutoff &lt;0.05 ## #...28 enriched terms found ## &#39;data.frame&#39;: 28 obs. of 9 variables: ## $ ID : chr &quot;DOID:0060071&quot; &quot;DOID:5295&quot; &quot;DOID:8719&quot; &quot;DOID:3007&quot; ... ## $ Description: chr &quot;pre-malignant neoplasm&quot; &quot;intestinal disease&quot; &quot;in situ carcinoma&quot; &quot;breast ductal carcinoma&quot; ... ## $ GeneRatio : chr &quot;5/77&quot; &quot;9/77&quot; &quot;4/77&quot; &quot;4/77&quot; ... ## $ BgRatio : chr &quot;22/8007&quot; &quot;157/8007&quot; &quot;18/8007&quot; &quot;29/8007&quot; ... ## $ pvalue : num 1.67e-06 1.76e-05 2.18e-05 1.56e-04 2.08e-04 ... ## $ p.adjust : num 0.00064 0.00279 0.00279 0.0136 0.0136 ... ## $ qvalue : num 0.000461 0.002008 0.002008 0.009796 0.009796 ... ## $ geneID : chr &quot;6280/6278/10232/332/4321&quot; &quot;4312/6279/3627/10563/4283/890/366/4902/3620&quot; &quot;6280/6278/10232/332&quot; &quot;6280/6279/4751/6286&quot; ... ## $ Count : int 5 9 4 4 13 6 13 5 5 6 ... ## #...Citation ## Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an ## R/Bioconductor package for Disease Ontology Semantic and Enrichment ## analysis. Bioinformatics 2015, 31(4):608-609 15.2 arrange mutate(x, geneRatio = parse_ratio(GeneRatio)) %&gt;% arrange(desc(geneRatio)) ## # ## # over-representation test ## # ## #...@organism Homo sapiens ## #...@ontology DO ## #...@keytype ENTREZID ## #...@gene chr [1:100] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; &quot;991&quot; &quot;6280&quot; &quot;2305&quot; ... ## #...pvalues adjusted by &#39;BH&#39; with cutoff &lt;0.05 ## #...28 enriched terms found ## &#39;data.frame&#39;: 28 obs. of 10 variables: ## $ ID : chr &quot;DOID:3908&quot; &quot;DOID:120&quot; &quot;DOID:2394&quot; &quot;DOID:3459&quot; ... ## $ Description: chr &quot;non-small cell lung carcinoma&quot; &quot;female reproductive organ cancer&quot; &quot;ovarian cancer&quot; &quot;breast carcinoma&quot; ... ## $ GeneRatio : chr &quot;13/77&quot; &quot;13/77&quot; &quot;10/77&quot; &quot;10/77&quot; ... ## $ BgRatio : chr &quot;431/8007&quot; &quot;455/8007&quot; &quot;312/8007&quot; &quot;383/8007&quot; ... ## $ pvalue : num 2.08e-04 3.52e-04 7.54e-04 3.48e-03 1.76e-05 ... ## $ p.adjust : num 0.0136 0.01928 0.02625 0.04756 0.00279 ... ## $ qvalue : num 0.0098 0.01389 0.0189 0.03424 0.00201 ... ## $ geneID : chr &quot;6280/2305/9133/6279/7153/6278/6241/11065/10232/332/6286/3002/9212&quot; &quot;4312/6279/7153/3627/820/983/10232/6362/332/6286/9212/4321/6790&quot; &quot;4312/820/983/10232/6362/332/6286/9212/4321/6790&quot; &quot;4312/6280/6279/7153/4751/890/4085/332/6286/6790&quot; ... ## $ Count : int 13 13 10 10 9 7 7 6 6 6 ... ## $ geneRatio : num 0.169 0.169 0.13 0.13 0.117 ... ## #...Citation ## Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an ## R/Bioconductor package for Disease Ontology Semantic and Enrichment ## analysis. Bioinformatics 2015, 31(4):608-609 15.3 select select(x, -geneID) %&gt;% head ## ID Description GeneRatio BgRatio ## DOID:0060071 DOID:0060071 pre-malignant neoplasm 5/77 22/8007 ## DOID:5295 DOID:5295 intestinal disease 9/77 157/8007 ## DOID:8719 DOID:8719 in situ carcinoma 4/77 18/8007 ## DOID:3007 DOID:3007 breast ductal carcinoma 4/77 29/8007 ## DOID:3908 DOID:3908 non-small cell lung carcinoma 13/77 431/8007 ## DOID:0050589 DOID:0050589 inflammatory bowel disease 6/77 90/8007 ## pvalue p.adjust qvalue Count ## DOID:0060071 1.671524e-06 0.0006401937 0.0004609887 5 ## DOID:5295 1.759049e-05 0.0027885022 0.0020079362 9 ## DOID:8719 2.184205e-05 0.0027885022 0.0020079362 4 ## DOID:3007 1.564603e-04 0.0136037018 0.0097957122 4 ## DOID:3908 2.075001e-04 0.0136037018 0.0097957122 13 ## DOID:0050589 2.131128e-04 0.0136037018 0.0097957122 6 15.4 mutate y &lt;- mutate(x, richFactor = Count / as.numeric(sub(&quot;/\\\\d+&quot;, &quot;&quot;, BgRatio))) y ## # ## # over-representation test ## # ## #...@organism Homo sapiens ## #...@ontology DO ## #...@keytype ENTREZID ## #...@gene chr [1:100] &quot;4312&quot; &quot;8318&quot; &quot;10874&quot; &quot;55143&quot; &quot;55388&quot; &quot;991&quot; &quot;6280&quot; &quot;2305&quot; ... ## #...pvalues adjusted by &#39;BH&#39; with cutoff &lt;0.05 ## #...28 enriched terms found ## &#39;data.frame&#39;: 28 obs. of 10 variables: ## $ ID : chr &quot;DOID:0060071&quot; &quot;DOID:5295&quot; &quot;DOID:8719&quot; &quot;DOID:3007&quot; ... ## $ Description: chr &quot;pre-malignant neoplasm&quot; &quot;intestinal disease&quot; &quot;in situ carcinoma&quot; &quot;breast ductal carcinoma&quot; ... ## $ GeneRatio : chr &quot;5/77&quot; &quot;9/77&quot; &quot;4/77&quot; &quot;4/77&quot; ... ## $ BgRatio : chr &quot;22/8007&quot; &quot;157/8007&quot; &quot;18/8007&quot; &quot;29/8007&quot; ... ## $ pvalue : num 1.67e-06 1.76e-05 2.18e-05 1.56e-04 2.08e-04 ... ## $ p.adjust : num 0.00064 0.00279 0.00279 0.0136 0.0136 ... ## $ qvalue : num 0.000461 0.002008 0.002008 0.009796 0.009796 ... ## $ geneID : chr &quot;6280/6278/10232/332/4321&quot; &quot;4312/6279/3627/10563/4283/890/366/4902/3620&quot; &quot;6280/6278/10232/332&quot; &quot;6280/6279/4751/6286&quot; ... ## $ Count : int 5 9 4 4 13 6 13 5 5 6 ... ## $ richFactor : num 0.2273 0.0573 0.2222 0.1379 0.0302 ... ## #...Citation ## Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an ## R/Bioconductor package for Disease Ontology Semantic and Enrichment ## analysis. Bioinformatics 2015, 31(4):608-609 library(ggplot2) library(forcats) library(enrichplot) ggplot(y, showCategory = 20, aes(richFactor, fct_reorder(Description, richFactor))) + geom_segment(aes(xend=0, yend = Description)) + geom_point(aes(color=p.adjust, size = Count)) + scale_color_viridis_c(guide=guide_colorbar(reverse=TRUE)) + scale_size_continuous(range=c(2, 10)) + theme_minimal() + xlab(&quot;rich factor&quot;) + ylab(NULL) + ggtitle(&quot;Enriched Disease Ontology&quot;) A very similar concept is Fold Enrichment, which is defined as the ratio of two proportions, (k/n) / (M/N). Using mutate to add the fold enrichment variable is also easy: mutate(x, FoldEnrichment = parse_ratio(GeneRatio) / parse_ratio(BgRatio)) 15.5 slice We can use slice to choose rows by their ordinal position in the enrichment result. Grouped result use the ordinal position with the group. In the following example, a GSEA result of Reactome pathway was sorted by the absolute values of NES and the result was grouped by the sign of NES. We then extracted first 5 rows of each groups. The result was displayed in Figure 15.1. library(ReactomePA) data(geneList) x &lt;- gsePathway(geneList) y &lt;- arrange(x, abs(NES)) %&gt;% group_by(sign(NES)) %&gt;% slice(1:5) library(forcats) library(ggplot2) library(ggstance) library(enrichplot) ggplot(y, aes(NES, fct_reorder(Description, NES), fill=qvalues), showCategory=10) + geom_barh(stat=&#39;identity&#39;) + scale_fill_continuous(low=&#39;red&#39;, high=&#39;blue&#39;, guide=guide_colorbar(reverse=TRUE)) + theme_minimal() + ylab(NULL) Figure 15.1: Choose pathways by ordinal positions. 15.6 summarise pi=seq(0, 1, length.out=11) mutate(x, pp = cut(pvalue, pi)) %&gt;% group_by(pp) %&gt;% summarise(cnt = n()) %&gt;% ggplot(aes(pp, cnt)) + geom_col() + theme_minimal() + xlab(&quot;p value intervals&quot;) + ylab(&quot;Frequency&quot;) + ggtitle(&quot;p value distribution&quot;) "],
["useful-utilities.html", "Chapter 16 Useful utilities 16.1 Translating Biological ID 16.2 setReadable: translating gene IDs to human readable symbols", " Chapter 16 Useful utilities 16.1 Translating Biological ID 16.1.1 bitr: Biological Id TranslatoR clusterProfiler provides bitr and bitr_kegg for converting ID types. Both bitr and bitr_kegg support many species including model and many non-model organisms. x &lt;- c(&quot;GPX3&quot;, &quot;GLRX&quot;, &quot;LBP&quot;, &quot;CRYAB&quot;, &quot;DEFB1&quot;, &quot;HCLS1&quot;, &quot;SOD2&quot;, &quot;HSPA2&quot;, &quot;ORM1&quot;, &quot;IGFBP1&quot;, &quot;PTHLH&quot;, &quot;GPC3&quot;, &quot;IGFBP3&quot;,&quot;TOB1&quot;, &quot;MITF&quot;, &quot;NDRG1&quot;, &quot;NR1H4&quot;, &quot;FGFR3&quot;, &quot;PVR&quot;, &quot;IL6&quot;, &quot;PTPRM&quot;, &quot;ERBB2&quot;, &quot;NID2&quot;, &quot;LAMB1&quot;, &quot;COMP&quot;, &quot;PLS3&quot;, &quot;MCAM&quot;, &quot;SPP1&quot;, &quot;LAMC1&quot;, &quot;COL4A2&quot;, &quot;COL4A1&quot;, &quot;MYOC&quot;, &quot;ANXA4&quot;, &quot;TFPI2&quot;, &quot;CST6&quot;, &quot;SLPI&quot;, &quot;TIMP2&quot;, &quot;CPM&quot;, &quot;GGT1&quot;, &quot;NNMT&quot;, &quot;MAL&quot;, &quot;EEF1A2&quot;, &quot;HGD&quot;, &quot;TCN2&quot;, &quot;CDA&quot;, &quot;PCCA&quot;, &quot;CRYM&quot;, &quot;PDXK&quot;, &quot;STC1&quot;, &quot;WARS&quot;, &quot;HMOX1&quot;, &quot;FXYD2&quot;, &quot;RBP4&quot;, &quot;SLC6A12&quot;, &quot;KDELR3&quot;, &quot;ITM2B&quot;) eg = bitr(x, fromType=&quot;SYMBOL&quot;, toType=&quot;ENTREZID&quot;, OrgDb=&quot;org.Hs.eg.db&quot;) head(eg) ## SYMBOL ENTREZID ## 1 GPX3 2878 ## 2 GLRX 2745 ## 3 LBP 3929 ## 4 CRYAB 1410 ## 5 DEFB1 1672 ## 6 HCLS1 3059 User should provides an annotation package, both fromType and toType can accept any types that supported. User can use keytypes to list all supporting types. library(org.Hs.eg.db) keytypes(org.Hs.eg.db) ## [1] &quot;ACCNUM&quot; &quot;ALIAS&quot; &quot;ENSEMBL&quot; &quot;ENSEMBLPROT&quot; &quot;ENSEMBLTRANS&quot; ## [6] &quot;ENTREZID&quot; &quot;ENZYME&quot; &quot;EVIDENCE&quot; &quot;EVIDENCEALL&quot; &quot;GENENAME&quot; ## [11] &quot;GO&quot; &quot;GOALL&quot; &quot;IPI&quot; &quot;MAP&quot; &quot;OMIM&quot; ## [16] &quot;ONTOLOGY&quot; &quot;ONTOLOGYALL&quot; &quot;PATH&quot; &quot;PFAM&quot; &quot;PMID&quot; ## [21] &quot;PROSITE&quot; &quot;REFSEQ&quot; &quot;SYMBOL&quot; &quot;UCSCKG&quot; &quot;UNIGENE&quot; ## [26] &quot;UNIPROT&quot; We can translate from one type to other types. ids &lt;- bitr(x, fromType=&quot;SYMBOL&quot;, toType=c(&quot;UNIPROT&quot;, &quot;ENSEMBL&quot;), OrgDb=&quot;org.Hs.eg.db&quot;) head(ids) ## SYMBOL UNIPROT ENSEMBL ## 1 GPX3 P22352 ENSG00000211445 ## 2 GLRX A0A024RAM2 ENSG00000173221 ## 3 GLRX P35754 ENSG00000173221 ## 4 LBP P18428 ENSG00000129988 ## 5 LBP Q8TCF0 ENSG00000129988 ## 6 CRYAB P02511 ENSG00000109846 For GO analysis, user don‚Äôt need to convert ID, all ID type provided by OrgDb can be used in groupGO, enrichGO and gseGO by specifying keyType parameter. 16.1.2 bitr_kegg: converting biological IDs using KEGG API data(gcSample) hg &lt;- gcSample[[1]] head(hg) ## [1] &quot;4597&quot; &quot;7111&quot; &quot;5266&quot; &quot;2175&quot; &quot;755&quot; &quot;23046&quot; eg2np &lt;- bitr_kegg(hg, fromType=&#39;kegg&#39;, toType=&#39;ncbi-proteinid&#39;, organism=&#39;hsa&#39;) head(eg2np) ## kegg ncbi-proteinid ## 1 10001 NP_005457 ## 2 10209 NP_005792 ## 3 10232 NP_037536 ## 4 10324 NP_006054 ## 5 10411 NP_001092002 ## 6 10614 NP_006451 The ID type (both fromType &amp; toType) should be one of ‚Äòkegg‚Äô, ‚Äòncbi-geneid‚Äô, ‚Äòncbi-proteinid‚Äô or ‚Äòuniprot‚Äô. The ‚Äòkegg‚Äô is the primary ID used in KEGG database. The data source of KEGG was from NCBI. A rule of thumb for the ‚Äòkegg‚Äô ID is entrezgene ID for eukaryote species and Locus ID for prokaryotes. Many prokaryote species don‚Äôt have entrezgene ID available. For example we can check the gene information of ece:Z5100 in http://www.genome.jp/dbget-bin/www_bget?ece:Z5100, which have NCBI-ProteinID and UnitProt links in the Other DBs Entry, but not NCBI-GeneID. If we try to convert Z5100 to ncbi-geneid, bitr_kegg will throw error of ncbi-geneid is not supported. bitr_kegg(&quot;Z5100&quot;, fromType=&quot;kegg&quot;, toType=&#39;ncbi-geneid&#39;, organism=&#39;ece&#39;) ## Error in KEGG_convert(fromType, toType, organism) : ## ncbi-geneid is not supported for ece ... We can of course convert it to ncbi-proteinid and uniprot: bitr_kegg(&quot;Z5100&quot;, fromType=&quot;kegg&quot;, toType=&#39;ncbi-proteinid&#39;, organism=&#39;ece&#39;) ## kegg ncbi-proteinid ## 1 Z5100 AAG58814 bitr_kegg(&quot;Z5100&quot;, fromType=&quot;kegg&quot;, toType=&#39;uniprot&#39;, organism=&#39;ece&#39;) ## kegg uniprot ## 1 Z5100 A0A4Q2TPW7 16.2 setReadable: translating gene IDs to human readable symbols Some of the functions, especially those internally supported for DO, GO, and Reactome Pathway, support a parameter, readable. If readable = TRUE, all the gene IDs will be translated to gene symbols. The readable parameter is not available for enrichment analysis of KEGG or using user‚Äôs own annotation. KEGG analysis using enrichKEGG and gseKEGG, internally query annotation information from KEEGG database and thus support all species if it is available in the KEGG database. However, KEGG database doesn‚Äôt provide gene ID to symbol mapping information. For analysis using user‚Äôs own annotation data, we even don‚Äôt know what species is in analyzed. Translating gene IDs to gene symbols is partly supported using the setReadable function if and only if there is an OrgDb available. library(org.Hs.eg.db) library(clusterProfiler) data(geneList, package=&quot;DOSE&quot;) de &lt;- names(geneList)[1:100] x &lt;- enrichKEGG(de) ## The geneID column is ENTREZID head(x, 3) ## ID Description GeneRatio BgRatio pvalue ## hsa04110 hsa04110 Cell cycle 8/48 124/8063 5.623183e-07 ## hsa04218 hsa04218 Cellular senescence 7/48 156/8063 3.355165e-05 ## hsa04114 hsa04114 Oocyte meiosis 6/48 128/8063 1.011404e-04 ## p.adjust qvalue geneID Count ## hsa04110 6.410428e-05 5.859948e-05 8318/991/9133/890/983/4085/7272/1111 8 ## hsa04218 1.912444e-03 1.748217e-03 2305/4605/9133/890/983/51806/1111 7 ## hsa04114 3.843336e-03 3.513299e-03 991/9133/983/4085/51806/6790 6 y &lt;- setReadable(x, OrgDb = org.Hs.eg.db, keyType=&quot;ENTREZID&quot;) ## The geneID column is translated to symbol head(y, 3) ## ID Description GeneRatio BgRatio pvalue ## hsa04110 hsa04110 Cell cycle 8/48 124/8063 5.623183e-07 ## hsa04218 hsa04218 Cellular senescence 7/48 156/8063 3.355165e-05 ## hsa04114 hsa04114 Oocyte meiosis 6/48 128/8063 1.011404e-04 ## p.adjust qvalue ## hsa04110 6.410428e-05 5.859948e-05 ## hsa04218 1.912444e-03 1.748217e-03 ## hsa04114 3.843336e-03 3.513299e-03 ## geneID Count ## hsa04110 CDC45/CDC20/CCNB2/CCNA2/CDK1/MAD2L1/TTK/CHEK1 8 ## hsa04218 FOXM1/MYBL2/CCNB2/CCNA2/CDK1/CALML5/CHEK1 7 ## hsa04114 CDC20/CCNB2/CDK1/MAD2L1/CALML5/AURKA 6 For those functions that internally support readable parameter, user can also use setReadable for translating gene IDs. "],
["faq.html", "A Frequently asked questions A.1 How to prepare your own geneList", " A Frequently asked questions A.1 How to prepare your own geneList GSEA analysis requires a ranked gene list, which contains three features: numeric vector: fold change or other type of numerical variable named vector: every number has a name, the corresponding gene ID sorted vector: number should be sorted in decreasing order If you import your data from a csv file, the file should contains two columns, one for gene ID (no duplicated ID allowed) and another one for fold change. d = read.csv(your_csv_file) ## assume 1st column is ID ## 2nd column is FC ## feature 1: numeric vector geneList = d[,2] ## feature 2: named vector names(geneList) = as.character(d[,1]) ## feature 3: decreasing orde geneList = sort(geneList, decreasing = TRUE) No gene can be mapped https://www.biostars.org/p/431270/ "],
["references.html", "References", " References A., Omer, Giovanni M. D., Thanos P. M., and Francesca D. C. 2016. ‚ÄúNCG 5.0: Updates of a Manually Curated Repository of Cancer Genes and Associated Properties from Cancer Mutational Screenings.‚Äù Nucleic Acids Research 44 (D1): D992‚ÄìD999. https://doi.org/10.1093/nar/gkv1123. Boyle, Elizabeth I, Shuai Weng, Jeremy Gollub, Heng Jin, David Botstein, J Michael Cherry, and Gavin Sherlock. 2004. ‚ÄúGO::TermFinder‚Äìopen Source Software for Accessing Gene Ontology Information and Finding Significantly Enriched Gene Ontology Terms Associated with a List of Genes.‚Äù Bioinformatics (Oxford, England) 20 (18): 3710‚Äì5. https://doi.org/10.1093/bioinformatics/bth456. Du, Pan, Gang Feng, Jared Flatow, Jie Song, Michelle Holko, Warren A. Kibbe, and Simon M. Lin. 2009. ‚ÄúFrom Disease Ontology to Disease-Ontology Lite: Statistical Methods to Adapt a General-Purpose Ontology for the Test of Gene-Ontology Associations.‚Äù Bioinformatics 25 (12): i63‚Äìi68. https://doi.org/10.1093/bioinformatics/btp193. Janet, P., N√∫ria Q. R., √Älex B., Jordi D. P., Anna B. M., Martin B., Ferran S., and Laura I. F. 2015. ‚ÄúDisGeNET: A Discovery Platform for the Dynamical Exploration of Human Diseases and Their Genes.‚Äù Database 2015 (March): bav028. https://doi.org/10.1093/database/bav028. Jiang, Jay J., and David W. Conrath. 1997. ‚ÄúSemantic Similarity Based on Corpus Statistics and Lexical Taxonomy.‚Äù Proceedings of 10th International Conference on Research in Computational Linguistics. http://www.citebase.org/abstract?id=oai:arXiv.org:cmp-lg/9709008. Korotkevich, Gennady, Vladimir Sukhov, and Alexey Sergushichev. 2019. ‚ÄúFast Gene Set Enrichment Analysis.‚Äù bioRxiv, October, 060012. https://doi.org/10.1101/060012. Lin, Dekang. 1998. ‚ÄúAn Information-Theoretic Definition of Similarity.‚Äù In Proceedings of the 15th International Conference on Machine Learning, 296‚Äî304. https://doi.org/10.1.1.55.1832. Luo, Weijun, and Cory Brouwer. 2013. ‚ÄúPathview: An R/Bioconductor Package for Pathway-Based Data Integration and Visualization.‚Äù Bioinformatics 29 (14): 1830‚Äì1. https://doi.org/10.1093/bioinformatics/btt285. Philip, Resnik. 1999. ‚ÄúSemantic Similarity in a Taxonomy: An Information-Based Measure and Its Application to Problems of Ambiguity in Natural Language.‚Äù Journal of Artificial Intelligence Research 11: 95‚Äì130. Schlicker, Andreas, Francisco S Domingues, J√∂rg Rahnenf√ºhrer, and Thomas Lengauer. 2006. ‚ÄúA New Measure for Functional Similarity of Gene Products Based on Gene Ontology.‚Äù BMC Bioinformatics 7: 302. https://doi.org/1471-2105-7-302. Schmidt, Marcus, Daniel B?hm, Christian von T?rne, Eric Steiner, Alexander Puhl, Henryk Pilch, Hans-Anton Lehr, Jan G. Hengstler, Heinz K?lbl, and Mathias Gehrmann. 2008. ‚ÄúThe Humoral Immune System Has a Key Prognostic Impact in Node-Negative Breast Cancer.‚Äù Cancer Research 68 (13): 5405‚Äì13. https://doi.org/10.1158/0008-5472.CAN-07-5206. Schriml, L. M., C. Arze, S. Nadendla, Y.-W. W. Chang, M. Mazaitis, V. Felix, G. Feng, and W. A. Kibbe. 2011. ‚ÄúDisease Ontology: A Backbone for Disease Semantic Integration.‚Äù Nucleic Acids Research 40 (D1): D940‚ÄìD946. https://doi.org/10.1093/nar/gkr972. Subramanian, Aravind, Pablo Tamayo, Vamsi K. Mootha, Sayan Mukherjee, Benjamin L. Ebert, Michael A. Gillette, Amanda Paulovich, et al. 2005. ‚ÄúGene Set Enrichment Analysis: A Knowledge-Based Approach for Interpreting Genome-Wide Expression Profiles.‚Äù Proceedings of the National Academy of Sciences of the United States of America 102 (43): 15545‚Äì50. https://doi.org/10.1073/pnas.0506580102. Wang, James Z, Zhidian Du, Rapeeporn Payattakool, Philip S Yu, and Chin-Fu Chen. 2007. ‚ÄúA New Method to Measure the Semantic Similarity of Go Terms.‚Äù Bioinformatics (Oxford, England) 23 (May): 1274‚Äì81. https://doi.org/btm087. Yu, Guangchuang. 2020. ‚ÄúGene Ontology Semantic Similarity Analysis Using GOSemSim.‚Äù Methods in Molecular Biology (Clifton, N.J.) 2117: 207‚Äì15. https://doi.org/10.1007/978-1-0716-0301-7_11. ‚Äî‚Äî‚Äî. 2018. ‚ÄúUsing Meshes for MeSH Term Enrichment and Semantic Analyses.‚Äù Bioinformatics 34 (21): 3766‚Äì7. https://doi.org/10.1093/bioinformatics/bty410. Yu, Guangchuang, and Qing-Yu He. 2016. ‚ÄúReactomePA: An R/Bioconductor Package for Reactome Pathway Analysis and Visualization.‚Äù Molecular BioSystems 12 (2): 477‚Äì79. https://doi.org/10.1039/C5MB00663E. Yu, Guangchuang, Fei Li, Yide Qin, Xiaochen Bo, Yibo Wu, and Shengqi Wang. 2010. ‚ÄúGOSemSim: An R Package for Measuring Semantic Similarity Among Go Terms and Gene Products.‚Äù Bioinformatics 26: 976‚Äì78. https://doi.org/10.1093/bioinformatics/btq064. Yu, Guangchuang, Li-Gen Wang, Yanyan Han, and Qing-Yu He. 2012. ‚ÄúclusterProfiler: an R Package for Comparing Biological Themes Among Gene Clusters.‚Äù OMICS: A Journal of Integrative Biology 16 (5): 284‚Äì87. https://doi.org/10.1089/omi.2011.0118. Yu, Guangchuang, Li-Gen Wang, and Qing-Yu He. 2015. ‚ÄúChIPseeker: An R/Bioconductor Package for Chip Peak Annotation, Comparison and Visualization.‚Äù Bioinformatics 31 (14): 2382‚Äì3. https://doi.org/10.1093/bioinformatics/btv145. Yu, Guangchuang, Li-Gen Wang, Guang-Rong Yan, and Qing-Yu He. 2015. ‚ÄúDOSE: An R/Bioconductor Package for Disease Ontology Semantic and Enrichment Analysis.‚Äù Bioinformatics 31 (4): 608‚Äì9. https://doi.org/10.1093/bioinformatics/btu684. "]
]
